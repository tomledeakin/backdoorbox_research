Creating poisoned training set for WaNet on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.559826, lr: 0.100000, Time: 10.19s
Clean ACC: 3488/8000 = 0.436000, Loss: 1.5259686708450317
ASR: 211/7193 = 0.029334


<Backdoor Training> Train Epoch: 2 	Loss: 1.101511, lr: 0.100000, Time: 6.46s
Clean ACC: 4601/8000 = 0.575125, Loss: 1.1681954860687256
ASR: 230/7193 = 0.031976


<Backdoor Training> Train Epoch: 3 	Loss: 1.028021, lr: 0.100000, Time: 6.34s
Clean ACC: 4816/8000 = 0.602000, Loss: 1.1409649848937988
ASR: 372/7193 = 0.051717


<Backdoor Training> Train Epoch: 4 	Loss: 0.725075, lr: 0.100000, Time: 6.25s
Clean ACC: 5390/8000 = 0.673750, Loss: 0.9372700452804565
ASR: 401/7193 = 0.055749


<Backdoor Training> Train Epoch: 5 	Loss: 0.910322, lr: 0.100000, Time: 6.31s
Clean ACC: 5679/8000 = 0.709875, Loss: 0.8339869379997253
ASR: 477/7193 = 0.066314


<Backdoor Training> Train Epoch: 6 	Loss: 0.570387, lr: 0.100000, Time: 6.29s
Clean ACC: 6051/8000 = 0.756375, Loss: 0.7184337973594666
ASR: 333/7193 = 0.046295


<Backdoor Training> Train Epoch: 7 	Loss: 0.514095, lr: 0.100000, Time: 6.48s
Clean ACC: 6250/8000 = 0.781250, Loss: 0.6376097202301025
ASR: 173/7193 = 0.024051


<Backdoor Training> Train Epoch: 8 	Loss: 0.580572, lr: 0.100000, Time: 6.34s
Clean ACC: 6342/8000 = 0.792750, Loss: 0.6205036044120789
ASR: 245/7193 = 0.034061


<Backdoor Training> Train Epoch: 9 	Loss: 0.598455, lr: 0.100000, Time: 6.48s
Clean ACC: 6612/8000 = 0.826500, Loss: 0.511005163192749
ASR: 174/7193 = 0.024190


<Backdoor Training> Train Epoch: 10 	Loss: 0.463079, lr: 0.100000, Time: 6.39s
Clean ACC: 6580/8000 = 0.822500, Loss: 0.5476571321487427
ASR: 437/7193 = 0.060754


<Backdoor Training> Train Epoch: 11 	Loss: 0.466524, lr: 0.100000, Time: 6.26s
Clean ACC: 6509/8000 = 0.813625, Loss: 0.5513125061988831
ASR: 105/7193 = 0.014598


<Backdoor Training> Train Epoch: 12 	Loss: 0.292869, lr: 0.100000, Time: 6.44s
Clean ACC: 6680/8000 = 0.835000, Loss: 0.5017961859703064
ASR: 278/7193 = 0.038649


<Backdoor Training> Train Epoch: 13 	Loss: 0.459644, lr: 0.100000, Time: 6.39s
Clean ACC: 6654/8000 = 0.831750, Loss: 0.4999992847442627
ASR: 195/7193 = 0.027110


<Backdoor Training> Train Epoch: 14 	Loss: 0.224459, lr: 0.100000, Time: 6.38s
Clean ACC: 6813/8000 = 0.851625, Loss: 0.44729265570640564
ASR: 192/7193 = 0.026693


<Backdoor Training> Train Epoch: 15 	Loss: 0.263112, lr: 0.100000, Time: 6.52s
Clean ACC: 6826/8000 = 0.853250, Loss: 0.43527844548225403
ASR: 136/7193 = 0.018907


<Backdoor Training> Train Epoch: 16 	Loss: 0.299715, lr: 0.100000, Time: 6.25s
Clean ACC: 6681/8000 = 0.835125, Loss: 0.5136345028877258
ASR: 459/7193 = 0.063812


<Backdoor Training> Train Epoch: 17 	Loss: 0.420170, lr: 0.100000, Time: 6.55s
Clean ACC: 6930/8000 = 0.866250, Loss: 0.41752785444259644
ASR: 260/7193 = 0.036146


<Backdoor Training> Train Epoch: 18 	Loss: 0.492290, lr: 0.100000, Time: 6.56s
Clean ACC: 7090/8000 = 0.886250, Loss: 0.34237146377563477
ASR: 138/7193 = 0.019185


<Backdoor Training> Train Epoch: 19 	Loss: 0.230748, lr: 0.100000, Time: 6.42s
Clean ACC: 7007/8000 = 0.875875, Loss: 0.3660261929035187
ASR: 278/7193 = 0.038649


<Backdoor Training> Train Epoch: 20 	Loss: 0.228273, lr: 0.100000, Time: 6.37s
Clean ACC: 7002/8000 = 0.875250, Loss: 0.3974841833114624
ASR: 345/7193 = 0.047963


<Backdoor Training> Train Epoch: 21 	Loss: 0.331630, lr: 0.100000, Time: 6.44s
Clean ACC: 6970/8000 = 0.871250, Loss: 0.40456822514533997
ASR: 426/7193 = 0.059224


<Backdoor Training> Train Epoch: 22 	Loss: 0.238098, lr: 0.100000, Time: 6.56s
Clean ACC: 7027/8000 = 0.878375, Loss: 0.3743705749511719
ASR: 573/7193 = 0.079661


<Backdoor Training> Train Epoch: 23 	Loss: 0.364233, lr: 0.100000, Time: 6.48s
Clean ACC: 7000/8000 = 0.875000, Loss: 0.3818815052509308
ASR: 677/7193 = 0.094119


<Backdoor Training> Train Epoch: 24 	Loss: 0.297753, lr: 0.100000, Time: 6.56s
Clean ACC: 7068/8000 = 0.883500, Loss: 0.374661922454834
ASR: 488/7193 = 0.067844


<Backdoor Training> Train Epoch: 25 	Loss: 0.342014, lr: 0.100000, Time: 6.49s
Clean ACC: 7021/8000 = 0.877625, Loss: 0.3886929154396057
ASR: 598/7193 = 0.083136


<Backdoor Training> Train Epoch: 26 	Loss: 0.220686, lr: 0.100000, Time: 6.55s
Clean ACC: 7005/8000 = 0.875625, Loss: 0.39209815859794617
ASR: 1943/7193 = 0.270124


<Backdoor Training> Train Epoch: 27 	Loss: 0.285806, lr: 0.100000, Time: 6.45s
Clean ACC: 7038/8000 = 0.879750, Loss: 0.3789862096309662
ASR: 1699/7193 = 0.236202


<Backdoor Training> Train Epoch: 28 	Loss: 0.147389, lr: 0.100000, Time: 6.54s
Clean ACC: 6897/8000 = 0.862125, Loss: 0.43862760066986084
ASR: 1503/7193 = 0.208953


<Backdoor Training> Train Epoch: 29 	Loss: 0.309495, lr: 0.100000, Time: 6.50s
Clean ACC: 7040/8000 = 0.880000, Loss: 0.3729991912841797
ASR: 1371/7193 = 0.190602


<Backdoor Training> Train Epoch: 30 	Loss: 0.303435, lr: 0.100000, Time: 6.45s
Clean ACC: 7110/8000 = 0.888750, Loss: 0.36789482831954956
ASR: 926/7193 = 0.128736


<Backdoor Training> Train Epoch: 31 	Loss: 0.146122, lr: 0.100000, Time: 6.54s
Clean ACC: 6987/8000 = 0.873375, Loss: 0.43910208344459534
ASR: 1086/7193 = 0.150980


<Backdoor Training> Train Epoch: 32 	Loss: 0.172959, lr: 0.100000, Time: 6.43s
Clean ACC: 7152/8000 = 0.894000, Loss: 0.35041627287864685
ASR: 927/7193 = 0.128875


<Backdoor Training> Train Epoch: 33 	Loss: 0.274317, lr: 0.100000, Time: 6.41s
Clean ACC: 6973/8000 = 0.871625, Loss: 0.42032328248023987
ASR: 2374/7193 = 0.330043


<Backdoor Training> Train Epoch: 34 	Loss: 0.210655, lr: 0.100000, Time: 6.48s
Clean ACC: 6989/8000 = 0.873625, Loss: 0.4174502491950989
ASR: 1814/7193 = 0.252190


<Backdoor Training> Train Epoch: 35 	Loss: 0.105429, lr: 0.100000, Time: 6.44s
Clean ACC: 7159/8000 = 0.894875, Loss: 0.3519243001937866
ASR: 2411/7193 = 0.335187


<Backdoor Training> Train Epoch: 36 	Loss: 0.114055, lr: 0.100000, Time: 6.44s
Clean ACC: 7148/8000 = 0.893500, Loss: 0.339321494102478
ASR: 2504/7193 = 0.348116


<Backdoor Training> Train Epoch: 37 	Loss: 0.233696, lr: 0.100000, Time: 6.56s
Clean ACC: 7043/8000 = 0.880375, Loss: 0.41090214252471924
ASR: 2685/7193 = 0.373280


<Backdoor Training> Train Epoch: 38 	Loss: 0.301922, lr: 0.100000, Time: 6.45s
Clean ACC: 6996/8000 = 0.874500, Loss: 0.4154376983642578
ASR: 3591/7193 = 0.499235


<Backdoor Training> Train Epoch: 39 	Loss: 0.115195, lr: 0.100000, Time: 6.54s
Clean ACC: 7031/8000 = 0.878875, Loss: 0.39705878496170044
ASR: 4162/7193 = 0.578618


<Backdoor Training> Train Epoch: 40 	Loss: 0.160673, lr: 0.100000, Time: 6.50s
Clean ACC: 7194/8000 = 0.899250, Loss: 0.35382845997810364
ASR: 2729/7193 = 0.379397


<Backdoor Training> Train Epoch: 41 	Loss: 0.073956, lr: 0.100000, Time: 6.47s
Clean ACC: 7115/8000 = 0.889375, Loss: 0.3764122724533081
ASR: 3344/7193 = 0.464896


<Backdoor Training> Train Epoch: 42 	Loss: 0.179209, lr: 0.100000, Time: 6.44s
Clean ACC: 7007/8000 = 0.875875, Loss: 0.4334663450717926
ASR: 2448/7193 = 0.340331


<Backdoor Training> Train Epoch: 43 	Loss: 0.045673, lr: 0.100000, Time: 6.50s
Clean ACC: 6861/8000 = 0.857625, Loss: 0.5031863451004028
ASR: 2907/7193 = 0.404143


<Backdoor Training> Train Epoch: 44 	Loss: 0.120837, lr: 0.100000, Time: 6.46s
Clean ACC: 7188/8000 = 0.898500, Loss: 0.3383738696575165
ASR: 1263/7193 = 0.175587


<Backdoor Training> Train Epoch: 45 	Loss: 0.090561, lr: 0.100000, Time: 6.49s
Clean ACC: 7086/8000 = 0.885750, Loss: 0.4267442524433136
ASR: 2516/7193 = 0.349785


<Backdoor Training> Train Epoch: 46 	Loss: 0.270652, lr: 0.100000, Time: 6.63s
Clean ACC: 7066/8000 = 0.883250, Loss: 0.3915100395679474
ASR: 2199/7193 = 0.305714


<Backdoor Training> Train Epoch: 47 	Loss: 0.133967, lr: 0.100000, Time: 6.64s
Clean ACC: 7091/8000 = 0.886375, Loss: 0.38908395171165466
ASR: 2750/7193 = 0.382316


<Backdoor Training> Train Epoch: 48 	Loss: 0.056099, lr: 0.100000, Time: 6.60s
Clean ACC: 7204/8000 = 0.900500, Loss: 0.3331110179424286
ASR: 2444/7193 = 0.339775


<Backdoor Training> Train Epoch: 49 	Loss: 0.189966, lr: 0.100000, Time: 6.50s
Clean ACC: 7181/8000 = 0.897625, Loss: 0.36608758568763733
ASR: 3011/7193 = 0.418601


<Backdoor Training> Train Epoch: 50 	Loss: 0.292009, lr: 0.100000, Time: 6.31s
Clean ACC: 7054/8000 = 0.881750, Loss: 0.40636712312698364
ASR: 5131/7193 = 0.713332


<Backdoor Training> Train Epoch: 51 	Loss: 0.033947, lr: 0.010000, Time: 6.42s
Clean ACC: 7416/8000 = 0.927000, Loss: 0.2386154681444168
ASR: 3583/7193 = 0.498123


<Backdoor Training> Train Epoch: 52 	Loss: 0.036834, lr: 0.010000, Time: 6.63s
Clean ACC: 7444/8000 = 0.930500, Loss: 0.23732073605060577
ASR: 3784/7193 = 0.526067


<Backdoor Training> Train Epoch: 53 	Loss: 0.008156, lr: 0.010000, Time: 6.57s
Clean ACC: 7447/8000 = 0.930875, Loss: 0.24143831431865692
ASR: 3421/7193 = 0.475601


<Backdoor Training> Train Epoch: 54 	Loss: 0.003437, lr: 0.010000, Time: 6.44s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.23835112154483795
ASR: 3308/7193 = 0.459892


<Backdoor Training> Train Epoch: 55 	Loss: 0.011960, lr: 0.010000, Time: 6.46s
Clean ACC: 7463/8000 = 0.932875, Loss: 0.24084094166755676
ASR: 3783/7193 = 0.525928


<Backdoor Training> Train Epoch: 56 	Loss: 0.012351, lr: 0.010000, Time: 6.42s
Clean ACC: 7453/8000 = 0.931625, Loss: 0.24783125519752502
ASR: 3935/7193 = 0.547060


<Backdoor Training> Train Epoch: 57 	Loss: 0.017016, lr: 0.010000, Time: 6.43s
Clean ACC: 7477/8000 = 0.934625, Loss: 0.2506347596645355
ASR: 3903/7193 = 0.542611


<Backdoor Training> Train Epoch: 58 	Loss: 0.013407, lr: 0.010000, Time: 6.41s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.2536720633506775
ASR: 3677/7193 = 0.511191


<Backdoor Training> Train Epoch: 59 	Loss: 0.007053, lr: 0.010000, Time: 6.46s
Clean ACC: 7477/8000 = 0.934625, Loss: 0.2593894898891449
ASR: 3776/7193 = 0.524955


<Backdoor Training> Train Epoch: 60 	Loss: 0.056272, lr: 0.010000, Time: 6.52s
Clean ACC: 7476/8000 = 0.934500, Loss: 0.2592453360557556
ASR: 3633/7193 = 0.505074


<Backdoor Training> Train Epoch: 61 	Loss: 0.004324, lr: 0.010000, Time: 6.53s
Clean ACC: 7475/8000 = 0.934375, Loss: 0.26143667101860046
ASR: 3698/7193 = 0.514111


<Backdoor Training> Train Epoch: 62 	Loss: 0.003350, lr: 0.010000, Time: 6.36s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.2602063715457916
ASR: 3825/7193 = 0.531767


<Backdoor Training> Train Epoch: 63 	Loss: 0.009375, lr: 0.010000, Time: 6.46s
Clean ACC: 7478/8000 = 0.934750, Loss: 0.26970019936561584
ASR: 3776/7193 = 0.524955


<Backdoor Training> Train Epoch: 64 	Loss: 0.003222, lr: 0.010000, Time: 6.49s
Clean ACC: 7480/8000 = 0.935000, Loss: 0.2696169316768646
ASR: 3698/7193 = 0.514111


<Backdoor Training> Train Epoch: 65 	Loss: 0.001060, lr: 0.010000, Time: 6.42s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.2716403305530548
ASR: 3601/7193 = 0.500626


<Backdoor Training> Train Epoch: 66 	Loss: 0.029639, lr: 0.010000, Time: 6.52s
Clean ACC: 7476/8000 = 0.934500, Loss: 0.2717928886413574
ASR: 3737/7193 = 0.519533


<Backdoor Training> Train Epoch: 67 	Loss: 0.022169, lr: 0.010000, Time: 6.50s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.26670509576797485
ASR: 3759/7193 = 0.522591


<Backdoor Training> Train Epoch: 68 	Loss: 0.001354, lr: 0.010000, Time: 6.38s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.26262104511260986
ASR: 3913/7193 = 0.544001


<Backdoor Training> Train Epoch: 69 	Loss: 0.006113, lr: 0.010000, Time: 6.56s
Clean ACC: 7488/8000 = 0.936000, Loss: 0.2694615423679352
ASR: 3846/7193 = 0.534687


<Backdoor Training> Train Epoch: 70 	Loss: 0.002311, lr: 0.010000, Time: 6.45s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.26715773344039917
ASR: 3825/7193 = 0.531767


<Backdoor Training> Train Epoch: 71 	Loss: 0.003338, lr: 0.010000, Time: 6.57s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.2707667052745819
ASR: 3655/7193 = 0.508133


<Backdoor Training> Train Epoch: 72 	Loss: 0.001592, lr: 0.010000, Time: 6.55s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.27283817529678345
ASR: 3870/7193 = 0.538023


<Backdoor Training> Train Epoch: 73 	Loss: 0.001457, lr: 0.010000, Time: 6.41s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.2772703170776367
ASR: 3685/7193 = 0.512304


<Backdoor Training> Train Epoch: 74 	Loss: 0.009126, lr: 0.010000, Time: 6.50s
Clean ACC: 7482/8000 = 0.935250, Loss: 0.27883589267730713
ASR: 3315/7193 = 0.460865


<Backdoor Training> Train Epoch: 75 	Loss: 0.002782, lr: 0.010000, Time: 6.60s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.28315356373786926
ASR: 3925/7193 = 0.545669


<Backdoor Training> Train Epoch: 76 	Loss: 0.008084, lr: 0.001000, Time: 6.51s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.2811468243598938
ASR: 3859/7193 = 0.536494


<Backdoor Training> Train Epoch: 77 	Loss: 0.005881, lr: 0.001000, Time: 6.40s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2808297574520111
ASR: 3717/7193 = 0.516752


<Backdoor Training> Train Epoch: 78 	Loss: 0.004102, lr: 0.001000, Time: 6.53s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.27809062600135803
ASR: 3776/7193 = 0.524955


<Backdoor Training> Train Epoch: 79 	Loss: 0.020605, lr: 0.001000, Time: 6.48s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.27718302607536316
ASR: 3818/7193 = 0.530794


<Backdoor Training> Train Epoch: 80 	Loss: 0.004034, lr: 0.001000, Time: 6.42s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.27808013558387756
ASR: 3918/7193 = 0.544696


<Backdoor Training> Train Epoch: 81 	Loss: 0.014867, lr: 0.001000, Time: 6.64s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.27715277671813965
ASR: 3791/7193 = 0.527040


<Backdoor Training> Train Epoch: 82 	Loss: 0.014684, lr: 0.001000, Time: 6.71s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2766301929950714
ASR: 3851/7193 = 0.535382


<Backdoor Training> Train Epoch: 83 	Loss: 0.003266, lr: 0.001000, Time: 6.33s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2768257260322571
ASR: 3899/7193 = 0.542055


<Backdoor Training> Train Epoch: 84 	Loss: 0.001331, lr: 0.001000, Time: 6.53s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.277093768119812
ASR: 3968/7193 = 0.551647


<Backdoor Training> Train Epoch: 85 	Loss: 0.001002, lr: 0.001000, Time: 6.56s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.27705976366996765
ASR: 3848/7193 = 0.534965


<Backdoor Training> Train Epoch: 86 	Loss: 0.004026, lr: 0.001000, Time: 6.53s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.275030255317688
ASR: 3613/7193 = 0.502294


<Backdoor Training> Train Epoch: 87 	Loss: 0.005926, lr: 0.001000, Time: 6.33s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2758095860481262
ASR: 3759/7193 = 0.522591


<Backdoor Training> Train Epoch: 88 	Loss: 0.003714, lr: 0.001000, Time: 6.46s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.2763637602329254
ASR: 3886/7193 = 0.540247


<Backdoor Training> Train Epoch: 89 	Loss: 0.001519, lr: 0.001000, Time: 6.45s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.2785724103450775
ASR: 3878/7193 = 0.539135


<Backdoor Training> Train Epoch: 90 	Loss: 0.000945, lr: 0.001000, Time: 6.46s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.2752649188041687
ASR: 3645/7193 = 0.506743


<Backdoor Training> Train Epoch: 91 	Loss: 0.018734, lr: 0.001000, Time: 6.79s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.27320393919944763
ASR: 3670/7193 = 0.510218


<Backdoor Training> Train Epoch: 92 	Loss: 0.001374, lr: 0.001000, Time: 6.59s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.27534034848213196
ASR: 3806/7193 = 0.529126


<Backdoor Training> Train Epoch: 93 	Loss: 0.003326, lr: 0.001000, Time: 6.59s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.2751341462135315
ASR: 3797/7193 = 0.527874


<Backdoor Training> Train Epoch: 94 	Loss: 0.000419, lr: 0.001000, Time: 6.67s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2737181484699249
ASR: 3577/7193 = 0.497289


<Backdoor Training> Train Epoch: 95 	Loss: 0.002130, lr: 0.001000, Time: 6.56s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2761114239692688
ASR: 3771/7193 = 0.524260


<Backdoor Training> Train Epoch: 96 	Loss: 0.002158, lr: 0.001000, Time: 6.80s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2764553725719452
ASR: 3944/7193 = 0.548311


<Backdoor Training> Train Epoch: 97 	Loss: 0.001389, lr: 0.001000, Time: 6.56s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.2742641270160675
ASR: 3931/7193 = 0.546504


<Backdoor Training> Train Epoch: 98 	Loss: 0.000960, lr: 0.001000, Time: 6.64s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.27472278475761414
ASR: 3752/7193 = 0.521618


<Backdoor Training> Train Epoch: 99 	Loss: 0.003557, lr: 0.001000, Time: 6.71s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.2757042348384857
ASR: 3795/7193 = 0.527596


<Backdoor Training> Train Epoch: 100 	Loss: 0.003736, lr: 0.001000, Time: 6.52s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2746809720993042
ASR: 3855/7193 = 0.535938


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2746809720993042
ASR: 3855/7193 = 0.535938

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/pca_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/tsne_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/umap_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
SVM Accuracy: 0.9955963302752293
Saved figure at assets/oracle_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Mean L2 distance between poison and clean: 6.50392484664917
Saved figure at assets/mean_diff_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
torch.Size([5450])
Saved figure at assets/SS_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/isomap_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/lle_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/kpca_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7499/8000 = 0.937375, Loss: 0.274677038192749
ASR: 3858/7193 = 0.536355

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.036182, poison_dis: 7.586572
Saved figure at assets/spectral_cifar10_WaNet_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/none
No trigger mask found! By default masking all black pixels...
Evaluating model 'poisoned_train_set/cifar10/WaNet_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.76250457763672
asr: 53.593772888183594
target label: tensor([0], device='cuda:0')
start_index: 10
TPR: 57.77
FPR: 6.76
AUC: 0.6416
f1 score: 0.7022715186507635
Elapsed time: 18.33s
Experiment for cifar10 with WaNet completed.
