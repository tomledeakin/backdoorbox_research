Creating poisoned training set for adaptive_blend on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.559515, lr: 0.100000, Time: 10.36s
Clean ACC: 3510/8000 = 0.438750, Loss: 1.5270692110061646
ASR: 681/7193 = 0.094675


<Backdoor Training> Train Epoch: 2 	Loss: 1.410921, lr: 0.100000, Time: 6.52s
Clean ACC: 4291/8000 = 0.536375, Loss: 1.2639195919036865
ASR: 736/7193 = 0.102322


<Backdoor Training> Train Epoch: 3 	Loss: 0.930074, lr: 0.100000, Time: 6.36s
Clean ACC: 4877/8000 = 0.609625, Loss: 1.1028099060058594
ASR: 1121/7193 = 0.155846


<Backdoor Training> Train Epoch: 4 	Loss: 1.057178, lr: 0.100000, Time: 6.28s
Clean ACC: 5376/8000 = 0.672000, Loss: 0.9308187961578369
ASR: 405/7193 = 0.056305


<Backdoor Training> Train Epoch: 5 	Loss: 0.710709, lr: 0.100000, Time: 6.46s
Clean ACC: 5451/8000 = 0.681375, Loss: 0.9128400683403015
ASR: 1013/7193 = 0.140831


<Backdoor Training> Train Epoch: 6 	Loss: 0.720922, lr: 0.100000, Time: 6.39s
Clean ACC: 5855/8000 = 0.731875, Loss: 0.7583311200141907
ASR: 2563/7193 = 0.356319


<Backdoor Training> Train Epoch: 7 	Loss: 0.623467, lr: 0.100000, Time: 6.23s
Clean ACC: 5868/8000 = 0.733500, Loss: 0.7732831239700317
ASR: 3314/7193 = 0.460726


<Backdoor Training> Train Epoch: 8 	Loss: 0.479415, lr: 0.100000, Time: 6.23s
Clean ACC: 6267/8000 = 0.783375, Loss: 0.6353498697280884
ASR: 4735/7193 = 0.658279


<Backdoor Training> Train Epoch: 9 	Loss: 0.610134, lr: 0.100000, Time: 6.31s
Clean ACC: 6280/8000 = 0.785000, Loss: 0.6511697173118591
ASR: 4845/7193 = 0.673572


<Backdoor Training> Train Epoch: 10 	Loss: 0.642644, lr: 0.100000, Time: 6.44s
Clean ACC: 6266/8000 = 0.783250, Loss: 0.6576075553894043
ASR: 5662/7193 = 0.787154


<Backdoor Training> Train Epoch: 11 	Loss: 0.420740, lr: 0.100000, Time: 6.33s
Clean ACC: 6671/8000 = 0.833875, Loss: 0.48341479897499084
ASR: 6193/7193 = 0.860976


<Backdoor Training> Train Epoch: 12 	Loss: 0.417865, lr: 0.100000, Time: 6.24s
Clean ACC: 6638/8000 = 0.829750, Loss: 0.4997650682926178
ASR: 6608/7193 = 0.918671


<Backdoor Training> Train Epoch: 13 	Loss: 0.434501, lr: 0.100000, Time: 6.34s
Clean ACC: 6640/8000 = 0.830000, Loss: 0.5030025243759155
ASR: 7075/7193 = 0.983595


<Backdoor Training> Train Epoch: 14 	Loss: 0.269844, lr: 0.100000, Time: 6.34s
Clean ACC: 6614/8000 = 0.826750, Loss: 0.5261037349700928
ASR: 7098/7193 = 0.986793


<Backdoor Training> Train Epoch: 15 	Loss: 0.273271, lr: 0.100000, Time: 6.28s
Clean ACC: 6767/8000 = 0.845875, Loss: 0.4673231840133667
ASR: 7031/7193 = 0.977478


<Backdoor Training> Train Epoch: 16 	Loss: 0.359152, lr: 0.100000, Time: 6.35s
Clean ACC: 6772/8000 = 0.846500, Loss: 0.4620025157928467
ASR: 6934/7193 = 0.963993


<Backdoor Training> Train Epoch: 17 	Loss: 0.333386, lr: 0.100000, Time: 6.43s
Clean ACC: 6807/8000 = 0.850875, Loss: 0.4569835662841797
ASR: 7043/7193 = 0.979146


<Backdoor Training> Train Epoch: 18 	Loss: 0.278194, lr: 0.100000, Time: 6.39s
Clean ACC: 6843/8000 = 0.855375, Loss: 0.4399062395095825
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 19 	Loss: 0.280787, lr: 0.100000, Time: 6.41s
Clean ACC: 6909/8000 = 0.863625, Loss: 0.4297632873058319
ASR: 7095/7193 = 0.986376


<Backdoor Training> Train Epoch: 20 	Loss: 0.309498, lr: 0.100000, Time: 6.30s
Clean ACC: 6930/8000 = 0.866250, Loss: 0.4047236740589142
ASR: 7124/7193 = 0.990407


<Backdoor Training> Train Epoch: 21 	Loss: 0.365560, lr: 0.100000, Time: 6.30s
Clean ACC: 6957/8000 = 0.869625, Loss: 0.3941963315010071
ASR: 6927/7193 = 0.963020


<Backdoor Training> Train Epoch: 22 	Loss: 0.151044, lr: 0.100000, Time: 6.20s
Clean ACC: 7078/8000 = 0.884750, Loss: 0.36613503098487854
ASR: 7098/7193 = 0.986793


<Backdoor Training> Train Epoch: 23 	Loss: 0.303062, lr: 0.100000, Time: 6.38s
Clean ACC: 6966/8000 = 0.870750, Loss: 0.4155292510986328
ASR: 6885/7193 = 0.957181


<Backdoor Training> Train Epoch: 24 	Loss: 0.251451, lr: 0.100000, Time: 6.48s
Clean ACC: 6947/8000 = 0.868375, Loss: 0.4278578460216522
ASR: 7120/7193 = 0.989851


<Backdoor Training> Train Epoch: 25 	Loss: 0.238834, lr: 0.100000, Time: 6.27s
Clean ACC: 6986/8000 = 0.873250, Loss: 0.3836500346660614
ASR: 7148/7193 = 0.993744


<Backdoor Training> Train Epoch: 26 	Loss: 0.237814, lr: 0.100000, Time: 6.26s
Clean ACC: 7057/8000 = 0.882125, Loss: 0.37993329763412476
ASR: 7172/7193 = 0.997080


<Backdoor Training> Train Epoch: 27 	Loss: 0.240304, lr: 0.100000, Time: 6.20s
Clean ACC: 6979/8000 = 0.872375, Loss: 0.4009392559528351
ASR: 7119/7193 = 0.989712


<Backdoor Training> Train Epoch: 28 	Loss: 0.200936, lr: 0.100000, Time: 6.14s
Clean ACC: 7040/8000 = 0.880000, Loss: 0.375203937292099
ASR: 7070/7193 = 0.982900


<Backdoor Training> Train Epoch: 29 	Loss: 0.159574, lr: 0.100000, Time: 6.35s
Clean ACC: 7109/8000 = 0.888625, Loss: 0.3638318181037903
ASR: 7114/7193 = 0.989017


<Backdoor Training> Train Epoch: 30 	Loss: 0.123765, lr: 0.100000, Time: 6.35s
Clean ACC: 7060/8000 = 0.882500, Loss: 0.37607911229133606
ASR: 7142/7193 = 0.992910


<Backdoor Training> Train Epoch: 31 	Loss: 0.267123, lr: 0.100000, Time: 6.23s
Clean ACC: 7116/8000 = 0.889500, Loss: 0.3603450357913971
ASR: 7160/7193 = 0.995412


<Backdoor Training> Train Epoch: 32 	Loss: 0.257540, lr: 0.100000, Time: 6.35s
Clean ACC: 7162/8000 = 0.895250, Loss: 0.34616619348526
ASR: 7174/7193 = 0.997359


<Backdoor Training> Train Epoch: 33 	Loss: 0.253946, lr: 0.100000, Time: 6.34s
Clean ACC: 6866/8000 = 0.858250, Loss: 0.46994084119796753
ASR: 7110/7193 = 0.988461


<Backdoor Training> Train Epoch: 34 	Loss: 0.204385, lr: 0.100000, Time: 6.46s
Clean ACC: 7018/8000 = 0.877250, Loss: 0.40971705317497253
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 35 	Loss: 0.218054, lr: 0.100000, Time: 6.33s
Clean ACC: 7110/8000 = 0.888750, Loss: 0.3763495087623596
ASR: 6779/7193 = 0.942444


<Backdoor Training> Train Epoch: 36 	Loss: 0.095970, lr: 0.100000, Time: 6.24s
Clean ACC: 7160/8000 = 0.895000, Loss: 0.3525902330875397
ASR: 7026/7193 = 0.976783


<Backdoor Training> Train Epoch: 37 	Loss: 0.117310, lr: 0.100000, Time: 6.23s
Clean ACC: 7139/8000 = 0.892375, Loss: 0.3421921133995056
ASR: 7137/7193 = 0.992215


<Backdoor Training> Train Epoch: 38 	Loss: 0.239059, lr: 0.100000, Time: 6.29s
Clean ACC: 6973/8000 = 0.871625, Loss: 0.40338650345802307
ASR: 7108/7193 = 0.988183


<Backdoor Training> Train Epoch: 39 	Loss: 0.067108, lr: 0.100000, Time: 6.43s
Clean ACC: 7019/8000 = 0.877375, Loss: 0.4017947316169739
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 40 	Loss: 0.114590, lr: 0.100000, Time: 6.73s
Clean ACC: 7106/8000 = 0.888250, Loss: 0.3645589351654053
ASR: 7159/7193 = 0.995273


<Backdoor Training> Train Epoch: 41 	Loss: 0.200804, lr: 0.100000, Time: 6.68s
Clean ACC: 7122/8000 = 0.890250, Loss: 0.3658193349838257
ASR: 7144/7193 = 0.993188


<Backdoor Training> Train Epoch: 42 	Loss: 0.256803, lr: 0.100000, Time: 6.83s
Clean ACC: 7131/8000 = 0.891375, Loss: 0.35672277212142944
ASR: 7059/7193 = 0.981371


<Backdoor Training> Train Epoch: 43 	Loss: 0.174511, lr: 0.100000, Time: 6.68s
Clean ACC: 7037/8000 = 0.879625, Loss: 0.41370636224746704
ASR: 7098/7193 = 0.986793


<Backdoor Training> Train Epoch: 44 	Loss: 0.220411, lr: 0.100000, Time: 6.73s
Clean ACC: 7097/8000 = 0.887125, Loss: 0.3901270031929016
ASR: 7169/7193 = 0.996663


<Backdoor Training> Train Epoch: 45 	Loss: 0.070012, lr: 0.100000, Time: 6.87s
Clean ACC: 7125/8000 = 0.890625, Loss: 0.3634542226791382
ASR: 7170/7193 = 0.996802


<Backdoor Training> Train Epoch: 46 	Loss: 0.223244, lr: 0.100000, Time: 6.52s
Clean ACC: 7136/8000 = 0.892000, Loss: 0.36106136441230774
ASR: 7140/7193 = 0.992632


<Backdoor Training> Train Epoch: 47 	Loss: 0.119902, lr: 0.100000, Time: 6.82s
Clean ACC: 7032/8000 = 0.879000, Loss: 0.4128090441226959
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 48 	Loss: 0.171125, lr: 0.100000, Time: 6.77s
Clean ACC: 7149/8000 = 0.893625, Loss: 0.37043991684913635
ASR: 7179/7193 = 0.998054


<Backdoor Training> Train Epoch: 49 	Loss: 0.104938, lr: 0.100000, Time: 6.31s
Clean ACC: 7117/8000 = 0.889625, Loss: 0.383872389793396
ASR: 7152/7193 = 0.994300


<Backdoor Training> Train Epoch: 50 	Loss: 0.147706, lr: 0.100000, Time: 6.30s
Clean ACC: 7194/8000 = 0.899250, Loss: 0.3535158336162567
ASR: 7170/7193 = 0.996802


<Backdoor Training> Train Epoch: 51 	Loss: 0.027509, lr: 0.010000, Time: 6.30s
Clean ACC: 7449/8000 = 0.931125, Loss: 0.2333831936120987
ASR: 7181/7193 = 0.998332


<Backdoor Training> Train Epoch: 52 	Loss: 0.016943, lr: 0.010000, Time: 6.36s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.23294445872306824
ASR: 7179/7193 = 0.998054


<Backdoor Training> Train Epoch: 53 	Loss: 0.037046, lr: 0.010000, Time: 6.45s
Clean ACC: 7463/8000 = 0.932875, Loss: 0.23812073469161987
ASR: 7179/7193 = 0.998054


<Backdoor Training> Train Epoch: 54 	Loss: 0.031731, lr: 0.010000, Time: 6.25s
Clean ACC: 7452/8000 = 0.931500, Loss: 0.24372051656246185
ASR: 7182/7193 = 0.998471


<Backdoor Training> Train Epoch: 55 	Loss: 0.064535, lr: 0.010000, Time: 6.29s
Clean ACC: 7459/8000 = 0.932375, Loss: 0.24494609236717224
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 56 	Loss: 0.012976, lr: 0.010000, Time: 6.23s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.2461942583322525
ASR: 7179/7193 = 0.998054


<Backdoor Training> Train Epoch: 57 	Loss: 0.009699, lr: 0.010000, Time: 6.33s
Clean ACC: 7478/8000 = 0.934750, Loss: 0.2463020533323288
ASR: 7179/7193 = 0.998054


<Backdoor Training> Train Epoch: 58 	Loss: 0.010585, lr: 0.010000, Time: 6.39s
Clean ACC: 7471/8000 = 0.933875, Loss: 0.2469962239265442
ASR: 7181/7193 = 0.998332


<Backdoor Training> Train Epoch: 59 	Loss: 0.003485, lr: 0.010000, Time: 6.32s
Clean ACC: 7475/8000 = 0.934375, Loss: 0.2485179603099823
ASR: 7188/7193 = 0.999305


<Backdoor Training> Train Epoch: 60 	Loss: 0.013643, lr: 0.010000, Time: 6.21s
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2529453933238983
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 61 	Loss: 0.026946, lr: 0.010000, Time: 6.36s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.25430136919021606
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 62 	Loss: 0.016568, lr: 0.010000, Time: 6.24s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.25637465715408325
ASR: 7178/7193 = 0.997915


<Backdoor Training> Train Epoch: 63 	Loss: 0.017930, lr: 0.010000, Time: 6.25s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2548167407512665
ASR: 7181/7193 = 0.998332


<Backdoor Training> Train Epoch: 64 	Loss: 0.002260, lr: 0.010000, Time: 6.38s
Clean ACC: 7479/8000 = 0.934875, Loss: 0.2595428228378296
ASR: 7183/7193 = 0.998610


<Backdoor Training> Train Epoch: 65 	Loss: 0.011909, lr: 0.010000, Time: 6.30s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.2662852704524994
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 66 	Loss: 0.007199, lr: 0.010000, Time: 6.39s
Clean ACC: 7478/8000 = 0.934750, Loss: 0.2644915282726288
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 67 	Loss: 0.014464, lr: 0.010000, Time: 6.17s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.26534655690193176
ASR: 7182/7193 = 0.998471


<Backdoor Training> Train Epoch: 68 	Loss: 0.002364, lr: 0.010000, Time: 6.29s
Clean ACC: 7477/8000 = 0.934625, Loss: 0.2664070129394531
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 69 	Loss: 0.003089, lr: 0.010000, Time: 6.22s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.26846420764923096
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 70 	Loss: 0.004496, lr: 0.010000, Time: 6.38s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.27119961380958557
ASR: 7183/7193 = 0.998610


<Backdoor Training> Train Epoch: 71 	Loss: 0.001473, lr: 0.010000, Time: 6.38s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.2686300575733185
ASR: 7183/7193 = 0.998610


<Backdoor Training> Train Epoch: 72 	Loss: 0.003871, lr: 0.010000, Time: 6.26s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.2705077826976776
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 73 	Loss: 0.005375, lr: 0.010000, Time: 6.19s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.27090635895729065
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 74 	Loss: 0.003383, lr: 0.010000, Time: 6.24s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.2740332782268524
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 75 	Loss: 0.005227, lr: 0.010000, Time: 6.33s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.2740651071071625
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 76 	Loss: 0.005915, lr: 0.001000, Time: 6.19s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.27118822932243347
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 77 	Loss: 0.006035, lr: 0.001000, Time: 6.13s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.27017563581466675
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 78 	Loss: 0.000849, lr: 0.001000, Time: 6.16s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.27100130915641785
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 79 	Loss: 0.001554, lr: 0.001000, Time: 6.29s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.2717810273170471
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 80 	Loss: 0.001064, lr: 0.001000, Time: 6.27s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2717810273170471
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 81 	Loss: 0.014283, lr: 0.001000, Time: 6.36s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.27007928490638733
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 82 	Loss: 0.001429, lr: 0.001000, Time: 6.32s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2697199881076813
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 83 	Loss: 0.002431, lr: 0.001000, Time: 6.49s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.27021971344947815
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 84 	Loss: 0.007513, lr: 0.001000, Time: 6.23s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.27048230171203613
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 85 	Loss: 0.000444, lr: 0.001000, Time: 6.34s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2684796154499054
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 86 	Loss: 0.001572, lr: 0.001000, Time: 6.31s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.27079564332962036
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 87 	Loss: 0.001654, lr: 0.001000, Time: 6.21s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.270587295293808
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 88 	Loss: 0.004862, lr: 0.001000, Time: 6.34s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.27108052372932434
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 89 	Loss: 0.001148, lr: 0.001000, Time: 6.38s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2698579430580139
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 90 	Loss: 0.005177, lr: 0.001000, Time: 6.34s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.26806220412254333
ASR: 7183/7193 = 0.998610


<Backdoor Training> Train Epoch: 91 	Loss: 0.003199, lr: 0.001000, Time: 6.27s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2697811722755432
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 92 	Loss: 0.002721, lr: 0.001000, Time: 6.26s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.27158451080322266
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 93 	Loss: 0.002388, lr: 0.001000, Time: 6.38s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.27050554752349854
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 94 	Loss: 0.001186, lr: 0.001000, Time: 6.26s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.2697223126888275
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 95 	Loss: 0.009170, lr: 0.001000, Time: 6.20s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.2701685428619385
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 96 	Loss: 0.000482, lr: 0.001000, Time: 6.26s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.26927149295806885
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 97 	Loss: 0.001463, lr: 0.001000, Time: 6.20s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.27192312479019165
ASR: 7184/7193 = 0.998749


<Backdoor Training> Train Epoch: 98 	Loss: 0.002595, lr: 0.001000, Time: 6.15s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.27068963646888733
ASR: 7188/7193 = 0.999305


<Backdoor Training> Train Epoch: 99 	Loss: 0.000824, lr: 0.001000, Time: 6.41s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.2730652689933777
ASR: 7186/7193 = 0.999027


<Backdoor Training> Train Epoch: 100 	Loss: 0.008994, lr: 0.001000, Time: 6.44s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.27104246616363525
ASR: 7183/7193 = 0.998610


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7493/8000 = 0.936625, Loss: 0.27104246616363525
ASR: 7183/7193 = 0.998610

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/pca_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/tsne_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/umap_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Mean L2 distance between poison and clean: 7.232485294342041
Saved figure at assets/mean_diff_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
torch.Size([5450])
Saved figure at assets/SS_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/isomap_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/lle_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/kpca_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7493/8000 = 0.936625, Loss: 0.271041601896286
ASR: 7183/7193 = 0.998610

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.227046, poison_dis: 7.668447
Saved figure at assets/spectral_cifar10_adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/hellokitty_32.png
trigger_mask_path: ./triggers/mask_hellokitty_32.png
Evaluating model 'poisoned_train_set/cifar10/adaptive_blend_0.010_alpha=0.200_cover=0.000_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.66250610351562
asr: 99.86097717285156
target label: tensor([0], device='cuda:0')
start_index: 9
TPR: 99.84
FPR: 5.50
AUC: 0.9976
f1 score: 0.9724234491994886
Elapsed time: 15.61s
Experiment for cifar10 with adaptive_blend completed.
