Creating poisoned training set for adaptive_k_way on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.457362, lr: 0.100000, Time: 10.42s
Clean ACC: 3294/8000 = 0.411750, Loss: 1.6248031854629517
ASR: 293/7193 = 0.040734


<Backdoor Training> Train Epoch: 2 	Loss: 1.211952, lr: 0.100000, Time: 6.82s
Clean ACC: 4077/8000 = 0.509625, Loss: 1.366167664527893
ASR: 407/7193 = 0.056583


<Backdoor Training> Train Epoch: 3 	Loss: 1.154004, lr: 0.100000, Time: 6.49s
Clean ACC: 4699/8000 = 0.587375, Loss: 1.131321907043457
ASR: 462/7193 = 0.064229


<Backdoor Training> Train Epoch: 4 	Loss: 0.768695, lr: 0.100000, Time: 6.58s
Clean ACC: 5282/8000 = 0.660250, Loss: 0.9633077383041382
ASR: 338/7193 = 0.046990


<Backdoor Training> Train Epoch: 5 	Loss: 1.108305, lr: 0.100000, Time: 6.53s
Clean ACC: 5399/8000 = 0.674875, Loss: 0.9588679671287537
ASR: 60/7193 = 0.008341


<Backdoor Training> Train Epoch: 6 	Loss: 0.560263, lr: 0.100000, Time: 6.50s
Clean ACC: 5884/8000 = 0.735500, Loss: 0.7552483677864075
ASR: 553/7193 = 0.076880


<Backdoor Training> Train Epoch: 7 	Loss: 0.638229, lr: 0.100000, Time: 6.37s
Clean ACC: 6189/8000 = 0.773625, Loss: 0.6640956997871399
ASR: 364/7193 = 0.050605


<Backdoor Training> Train Epoch: 8 	Loss: 0.406404, lr: 0.100000, Time: 6.33s
Clean ACC: 6316/8000 = 0.789500, Loss: 0.6266362071037292
ASR: 256/7193 = 0.035590


<Backdoor Training> Train Epoch: 9 	Loss: 0.568908, lr: 0.100000, Time: 6.63s
Clean ACC: 6651/8000 = 0.831375, Loss: 0.5020774006843567
ASR: 318/7193 = 0.044210


<Backdoor Training> Train Epoch: 10 	Loss: 0.578299, lr: 0.100000, Time: 6.79s
Clean ACC: 6470/8000 = 0.808750, Loss: 0.5298824310302734
ASR: 181/7193 = 0.025163


<Backdoor Training> Train Epoch: 11 	Loss: 0.453082, lr: 0.100000, Time: 6.51s
Clean ACC: 6431/8000 = 0.803875, Loss: 0.5897664427757263
ASR: 347/7193 = 0.048241


<Backdoor Training> Train Epoch: 12 	Loss: 0.537470, lr: 0.100000, Time: 6.54s
Clean ACC: 6757/8000 = 0.844625, Loss: 0.46808427572250366
ASR: 233/7193 = 0.032393


<Backdoor Training> Train Epoch: 13 	Loss: 0.610911, lr: 0.100000, Time: 6.81s
Clean ACC: 6857/8000 = 0.857125, Loss: 0.4184345006942749
ASR: 436/7193 = 0.060614


<Backdoor Training> Train Epoch: 14 	Loss: 0.294756, lr: 0.100000, Time: 6.46s
Clean ACC: 6834/8000 = 0.854250, Loss: 0.4416252374649048
ASR: 486/7193 = 0.067566


<Backdoor Training> Train Epoch: 15 	Loss: 0.340597, lr: 0.100000, Time: 6.54s
Clean ACC: 6774/8000 = 0.846750, Loss: 0.4750845730304718
ASR: 3029/7193 = 0.421104


<Backdoor Training> Train Epoch: 16 	Loss: 0.387846, lr: 0.100000, Time: 6.51s
Clean ACC: 6879/8000 = 0.859875, Loss: 0.40558096766471863
ASR: 4462/7193 = 0.620325


<Backdoor Training> Train Epoch: 17 	Loss: 0.328704, lr: 0.100000, Time: 6.52s
Clean ACC: 6953/8000 = 0.869125, Loss: 0.4089912474155426
ASR: 5387/7193 = 0.748923


<Backdoor Training> Train Epoch: 18 	Loss: 0.324785, lr: 0.100000, Time: 6.72s
Clean ACC: 6820/8000 = 0.852500, Loss: 0.4797866642475128
ASR: 6377/7193 = 0.886556


<Backdoor Training> Train Epoch: 19 	Loss: 0.264597, lr: 0.100000, Time: 6.63s
Clean ACC: 6906/8000 = 0.863250, Loss: 0.4278833270072937
ASR: 6272/7193 = 0.871959


<Backdoor Training> Train Epoch: 20 	Loss: 0.241738, lr: 0.100000, Time: 6.53s
Clean ACC: 6938/8000 = 0.867250, Loss: 0.4106537997722626
ASR: 6710/7193 = 0.932851


<Backdoor Training> Train Epoch: 21 	Loss: 0.262709, lr: 0.100000, Time: 6.61s
Clean ACC: 6805/8000 = 0.850625, Loss: 0.48185497522354126
ASR: 6886/7193 = 0.957320


<Backdoor Training> Train Epoch: 22 	Loss: 0.307677, lr: 0.100000, Time: 6.73s
Clean ACC: 6918/8000 = 0.864750, Loss: 0.42699047923088074
ASR: 6845/7193 = 0.951620


<Backdoor Training> Train Epoch: 23 	Loss: 0.235392, lr: 0.100000, Time: 6.78s
Clean ACC: 6905/8000 = 0.863125, Loss: 0.4449979066848755
ASR: 6973/7193 = 0.969415


<Backdoor Training> Train Epoch: 24 	Loss: 0.199063, lr: 0.100000, Time: 6.69s
Clean ACC: 6736/8000 = 0.842000, Loss: 0.5322745442390442
ASR: 6848/7193 = 0.952037


<Backdoor Training> Train Epoch: 25 	Loss: 0.228639, lr: 0.100000, Time: 6.69s
Clean ACC: 6983/8000 = 0.872875, Loss: 0.41081029176712036
ASR: 6717/7193 = 0.933825


<Backdoor Training> Train Epoch: 26 	Loss: 0.287855, lr: 0.100000, Time: 6.43s
Clean ACC: 6983/8000 = 0.872875, Loss: 0.40072762966156006
ASR: 6932/7193 = 0.963715


<Backdoor Training> Train Epoch: 27 	Loss: 0.145538, lr: 0.100000, Time: 6.42s
Clean ACC: 7041/8000 = 0.880125, Loss: 0.3848129212856293
ASR: 7065/7193 = 0.982205


<Backdoor Training> Train Epoch: 28 	Loss: 0.287545, lr: 0.100000, Time: 6.53s
Clean ACC: 7059/8000 = 0.882375, Loss: 0.36428213119506836
ASR: 7050/7193 = 0.980120


<Backdoor Training> Train Epoch: 29 	Loss: 0.226121, lr: 0.100000, Time: 6.54s
Clean ACC: 7052/8000 = 0.881500, Loss: 0.3734586536884308
ASR: 7036/7193 = 0.978173


<Backdoor Training> Train Epoch: 30 	Loss: 0.276977, lr: 0.100000, Time: 6.53s
Clean ACC: 7082/8000 = 0.885250, Loss: 0.367914617061615
ASR: 7082/7193 = 0.984568


<Backdoor Training> Train Epoch: 31 	Loss: 0.336144, lr: 0.100000, Time: 6.35s
Clean ACC: 7122/8000 = 0.890250, Loss: 0.3491854667663574
ASR: 6927/7193 = 0.963020


<Backdoor Training> Train Epoch: 32 	Loss: 0.137109, lr: 0.100000, Time: 6.51s
Clean ACC: 7069/8000 = 0.883625, Loss: 0.36966902017593384
ASR: 7104/7193 = 0.987627


<Backdoor Training> Train Epoch: 33 	Loss: 0.218696, lr: 0.100000, Time: 6.38s
Clean ACC: 7040/8000 = 0.880000, Loss: 0.4099641740322113
ASR: 6974/7193 = 0.969554


<Backdoor Training> Train Epoch: 34 	Loss: 0.255045, lr: 0.100000, Time: 6.47s
Clean ACC: 7109/8000 = 0.888625, Loss: 0.35050517320632935
ASR: 6899/7193 = 0.959127


<Backdoor Training> Train Epoch: 35 	Loss: 0.174942, lr: 0.100000, Time: 6.55s
Clean ACC: 7027/8000 = 0.878375, Loss: 0.43111151456832886
ASR: 6999/7193 = 0.973029


<Backdoor Training> Train Epoch: 36 	Loss: 0.297112, lr: 0.100000, Time: 6.65s
Clean ACC: 7138/8000 = 0.892250, Loss: 0.3464253842830658
ASR: 6721/7193 = 0.934381


<Backdoor Training> Train Epoch: 37 	Loss: 0.204626, lr: 0.100000, Time: 6.59s
Clean ACC: 7064/8000 = 0.883000, Loss: 0.38031092286109924
ASR: 6990/7193 = 0.971778


<Backdoor Training> Train Epoch: 38 	Loss: 0.268506, lr: 0.100000, Time: 6.59s
Clean ACC: 7178/8000 = 0.897250, Loss: 0.34359869360923767
ASR: 6729/7193 = 0.935493


<Backdoor Training> Train Epoch: 39 	Loss: 0.338936, lr: 0.100000, Time: 6.53s
Clean ACC: 7093/8000 = 0.886625, Loss: 0.3730218708515167
ASR: 7002/7193 = 0.973446


<Backdoor Training> Train Epoch: 40 	Loss: 0.176584, lr: 0.100000, Time: 6.51s
Clean ACC: 6974/8000 = 0.871750, Loss: 0.4326595366001129
ASR: 7045/7193 = 0.979424


<Backdoor Training> Train Epoch: 41 	Loss: 0.095836, lr: 0.100000, Time: 6.52s
Clean ACC: 7191/8000 = 0.898875, Loss: 0.32350340485572815
ASR: 6650/7193 = 0.924510


<Backdoor Training> Train Epoch: 42 	Loss: 0.202791, lr: 0.100000, Time: 6.44s
Clean ACC: 7120/8000 = 0.890000, Loss: 0.3837747871875763
ASR: 6671/7193 = 0.927429


<Backdoor Training> Train Epoch: 43 	Loss: 0.352523, lr: 0.100000, Time: 6.50s
Clean ACC: 7134/8000 = 0.891750, Loss: 0.34744298458099365
ASR: 7028/7193 = 0.977061


<Backdoor Training> Train Epoch: 44 	Loss: 0.169432, lr: 0.100000, Time: 6.35s
Clean ACC: 7099/8000 = 0.887375, Loss: 0.37719759345054626
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 45 	Loss: 0.147781, lr: 0.100000, Time: 6.57s
Clean ACC: 7090/8000 = 0.886250, Loss: 0.40229281783103943
ASR: 7090/7193 = 0.985681


<Backdoor Training> Train Epoch: 46 	Loss: 0.227010, lr: 0.100000, Time: 6.47s
Clean ACC: 7178/8000 = 0.897250, Loss: 0.3393174707889557
ASR: 7100/7193 = 0.987071


<Backdoor Training> Train Epoch: 47 	Loss: 0.143984, lr: 0.100000, Time: 6.44s
Clean ACC: 7091/8000 = 0.886375, Loss: 0.3866093158721924
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 48 	Loss: 0.117807, lr: 0.100000, Time: 6.52s
Clean ACC: 7146/8000 = 0.893250, Loss: 0.35180917382240295
ASR: 7028/7193 = 0.977061


<Backdoor Training> Train Epoch: 49 	Loss: 0.353641, lr: 0.100000, Time: 6.53s
Clean ACC: 7122/8000 = 0.890250, Loss: 0.3832862377166748
ASR: 7126/7193 = 0.990685


<Backdoor Training> Train Epoch: 50 	Loss: 0.269943, lr: 0.100000, Time: 6.59s
Clean ACC: 7220/8000 = 0.902500, Loss: 0.3145696520805359
ASR: 7089/7193 = 0.985541


<Backdoor Training> Train Epoch: 51 	Loss: 0.028129, lr: 0.010000, Time: 6.51s
Clean ACC: 7440/8000 = 0.930000, Loss: 0.22992779314517975
ASR: 7113/7193 = 0.988878


<Backdoor Training> Train Epoch: 52 	Loss: 0.020423, lr: 0.010000, Time: 6.53s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.22378727793693542
ASR: 7118/7193 = 0.989573


<Backdoor Training> Train Epoch: 53 	Loss: 0.033478, lr: 0.010000, Time: 6.64s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2253522276878357
ASR: 7129/7193 = 0.991102


<Backdoor Training> Train Epoch: 54 	Loss: 0.034894, lr: 0.010000, Time: 6.47s
Clean ACC: 7505/8000 = 0.938125, Loss: 0.22867104411125183
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 55 	Loss: 0.055007, lr: 0.010000, Time: 6.39s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.22875863313674927
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 56 	Loss: 0.005737, lr: 0.010000, Time: 6.50s
Clean ACC: 7507/8000 = 0.938375, Loss: 0.2331848442554474
ASR: 7134/7193 = 0.991798


<Backdoor Training> Train Epoch: 57 	Loss: 0.031347, lr: 0.010000, Time: 6.62s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.23238487541675568
ASR: 7129/7193 = 0.991102


<Backdoor Training> Train Epoch: 58 	Loss: 0.017168, lr: 0.010000, Time: 6.59s
Clean ACC: 7515/8000 = 0.939375, Loss: 0.2410571426153183
ASR: 7130/7193 = 0.991241


<Backdoor Training> Train Epoch: 59 	Loss: 0.049348, lr: 0.010000, Time: 6.40s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.24260178208351135
ASR: 7131/7193 = 0.991381


<Backdoor Training> Train Epoch: 60 	Loss: 0.016974, lr: 0.010000, Time: 6.61s
Clean ACC: 7513/8000 = 0.939125, Loss: 0.2439606487751007
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 61 	Loss: 0.008166, lr: 0.010000, Time: 6.53s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2468494176864624
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 62 	Loss: 0.004083, lr: 0.010000, Time: 6.49s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.2517405152320862
ASR: 7137/7193 = 0.992215


<Backdoor Training> Train Epoch: 63 	Loss: 0.030758, lr: 0.010000, Time: 6.50s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.24653983116149902
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 64 	Loss: 0.030918, lr: 0.010000, Time: 6.59s
Clean ACC: 7526/8000 = 0.940750, Loss: 0.25080543756484985
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 65 	Loss: 0.107402, lr: 0.010000, Time: 6.55s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2534574568271637
ASR: 7135/7193 = 0.991937


<Backdoor Training> Train Epoch: 66 	Loss: 0.007794, lr: 0.010000, Time: 6.42s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.25096288323402405
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 67 	Loss: 0.012068, lr: 0.010000, Time: 6.52s
Clean ACC: 7537/8000 = 0.942125, Loss: 0.2531571090221405
ASR: 7118/7193 = 0.989573


<Backdoor Training> Train Epoch: 68 	Loss: 0.030510, lr: 0.010000, Time: 6.54s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2580125331878662
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 69 	Loss: 0.019847, lr: 0.010000, Time: 6.53s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.26058506965637207
ASR: 7137/7193 = 0.992215


<Backdoor Training> Train Epoch: 70 	Loss: 0.008639, lr: 0.010000, Time: 6.40s
Clean ACC: 7513/8000 = 0.939125, Loss: 0.2603819668292999
ASR: 7129/7193 = 0.991102


<Backdoor Training> Train Epoch: 71 	Loss: 0.002789, lr: 0.010000, Time: 6.42s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2677202820777893
ASR: 7138/7193 = 0.992354


<Backdoor Training> Train Epoch: 72 	Loss: 0.010189, lr: 0.010000, Time: 6.44s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.2657645344734192
ASR: 7124/7193 = 0.990407


<Backdoor Training> Train Epoch: 73 	Loss: 0.002267, lr: 0.010000, Time: 6.53s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.2633015215396881
ASR: 7114/7193 = 0.989017


<Backdoor Training> Train Epoch: 74 	Loss: 0.002929, lr: 0.010000, Time: 6.40s
Clean ACC: 7510/8000 = 0.938750, Loss: 0.2677820026874542
ASR: 7118/7193 = 0.989573


<Backdoor Training> Train Epoch: 75 	Loss: 0.004316, lr: 0.010000, Time: 6.40s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.2679579555988312
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 76 	Loss: 0.012143, lr: 0.001000, Time: 6.51s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.2683616280555725
ASR: 7129/7193 = 0.991102


<Backdoor Training> Train Epoch: 77 	Loss: 0.028395, lr: 0.001000, Time: 6.52s
Clean ACC: 7512/8000 = 0.939000, Loss: 0.2670792043209076
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 78 	Loss: 0.008475, lr: 0.001000, Time: 6.49s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.26580169796943665
ASR: 7128/7193 = 0.990963


<Backdoor Training> Train Epoch: 79 	Loss: 0.042280, lr: 0.001000, Time: 6.41s
Clean ACC: 7521/8000 = 0.940125, Loss: 0.26283344626426697
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 80 	Loss: 0.009691, lr: 0.001000, Time: 6.50s
Clean ACC: 7520/8000 = 0.940000, Loss: 0.2659444510936737
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 81 	Loss: 0.003263, lr: 0.001000, Time: 6.53s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.26416024565696716
ASR: 7123/7193 = 0.990268


<Backdoor Training> Train Epoch: 82 	Loss: 0.003773, lr: 0.001000, Time: 6.50s
Clean ACC: 7527/8000 = 0.940875, Loss: 0.2663387954235077
ASR: 7123/7193 = 0.990268


<Backdoor Training> Train Epoch: 83 	Loss: 0.003958, lr: 0.001000, Time: 6.44s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2655508518218994
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 84 	Loss: 0.055097, lr: 0.001000, Time: 6.52s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.2636373043060303
ASR: 7126/7193 = 0.990685


<Backdoor Training> Train Epoch: 85 	Loss: 0.003727, lr: 0.001000, Time: 6.41s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26470300555229187
ASR: 7121/7193 = 0.989990


<Backdoor Training> Train Epoch: 86 	Loss: 0.007591, lr: 0.001000, Time: 6.37s
Clean ACC: 7523/8000 = 0.940375, Loss: 0.2648528516292572
ASR: 7128/7193 = 0.990963


<Backdoor Training> Train Epoch: 87 	Loss: 0.011540, lr: 0.001000, Time: 6.48s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2653857171535492
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 88 	Loss: 0.005293, lr: 0.001000, Time: 6.42s
Clean ACC: 7526/8000 = 0.940750, Loss: 0.26618263125419617
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 89 	Loss: 0.001838, lr: 0.001000, Time: 6.48s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.265489786863327
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 90 	Loss: 0.003158, lr: 0.001000, Time: 6.42s
Clean ACC: 7520/8000 = 0.940000, Loss: 0.26455071568489075
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 91 	Loss: 0.003588, lr: 0.001000, Time: 6.49s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.2639390826225281
ASR: 7116/7193 = 0.989295


<Backdoor Training> Train Epoch: 92 	Loss: 0.000993, lr: 0.001000, Time: 6.65s
Clean ACC: 7527/8000 = 0.940875, Loss: 0.264824241399765
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 93 	Loss: 0.010305, lr: 0.001000, Time: 6.41s
Clean ACC: 7517/8000 = 0.939625, Loss: 0.26513078808784485
ASR: 7124/7193 = 0.990407


<Backdoor Training> Train Epoch: 94 	Loss: 0.004133, lr: 0.001000, Time: 6.65s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.2649350166320801
ASR: 7133/7193 = 0.991659


<Backdoor Training> Train Epoch: 95 	Loss: 0.003415, lr: 0.001000, Time: 6.44s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2665291726589203
ASR: 7127/7193 = 0.990824


<Backdoor Training> Train Epoch: 96 	Loss: 0.006820, lr: 0.001000, Time: 6.50s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.2640465795993805
ASR: 7130/7193 = 0.991241


<Backdoor Training> Train Epoch: 97 	Loss: 0.001426, lr: 0.001000, Time: 6.44s
Clean ACC: 7523/8000 = 0.940375, Loss: 0.2652902901172638
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 98 	Loss: 0.005255, lr: 0.001000, Time: 6.50s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.26337194442749023
ASR: 7122/7193 = 0.990129


<Backdoor Training> Train Epoch: 99 	Loss: 0.000562, lr: 0.001000, Time: 6.46s
Clean ACC: 7521/8000 = 0.940125, Loss: 0.2647111713886261
ASR: 7131/7193 = 0.991381


<Backdoor Training> Train Epoch: 100 	Loss: 0.005618, lr: 0.001000, Time: 6.53s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2655138671398163
ASR: 7132/7193 = 0.991520


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2655138671398163
ASR: 7132/7193 = 0.991520

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/pca_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/tsne_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/umap_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
SVM Accuracy: 0.99651376146789
Saved figure at assets/oracle_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Mean L2 distance between poison and clean: 5.561313152313232
Saved figure at assets/mean_diff_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
torch.Size([5450])
Saved figure at assets/SS_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/isomap_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/lle_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/kpca_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26549676060676575
ASR: 7132/7193 = 0.991520

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.050972, poison_dis: 6.645877
Saved figure at assets/spectral_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/none
No trigger mask found! By default masking all black pixels...
Evaluating model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 94.05000305175781
asr: 99.1519546508789
target label: tensor([0], device='cuda:0')
start_index: 5
TPR: 96.84
FPR: 16.34
AUC: 0.9636
f1 score: 0.9085258590360032
Elapsed time: 15.23s
Experiment for cifar10 with adaptive_k_way completed.
