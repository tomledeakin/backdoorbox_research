Creating poisoned training set for adaptive_patch on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.516394, lr: 0.100000, Time: 9.17s
Clean ACC: 3430/8000 = 0.428750, Loss: 1.551233172416687
ASR: 587/7193 = 0.081607


<Backdoor Training> Train Epoch: 2 	Loss: 1.214499, lr: 0.100000, Time: 6.52s
Clean ACC: 3971/8000 = 0.496375, Loss: 1.4473294019699097
ASR: 335/7193 = 0.046573


<Backdoor Training> Train Epoch: 3 	Loss: 0.819286, lr: 0.100000, Time: 6.33s
Clean ACC: 4654/8000 = 0.581750, Loss: 1.1726402044296265
ASR: 225/7193 = 0.031280


<Backdoor Training> Train Epoch: 4 	Loss: 0.915155, lr: 0.100000, Time: 6.40s
Clean ACC: 5025/8000 = 0.628125, Loss: 1.0221658945083618
ASR: 273/7193 = 0.037954


<Backdoor Training> Train Epoch: 5 	Loss: 1.178037, lr: 0.100000, Time: 6.53s
Clean ACC: 5512/8000 = 0.689000, Loss: 0.8925737738609314
ASR: 109/7193 = 0.015154


<Backdoor Training> Train Epoch: 6 	Loss: 0.648758, lr: 0.100000, Time: 6.48s
Clean ACC: 5888/8000 = 0.736000, Loss: 0.7762737274169922
ASR: 191/7193 = 0.026554


<Backdoor Training> Train Epoch: 7 	Loss: 0.652587, lr: 0.100000, Time: 6.53s
Clean ACC: 6225/8000 = 0.778125, Loss: 0.6532495021820068
ASR: 190/7193 = 0.026415


<Backdoor Training> Train Epoch: 8 	Loss: 0.645807, lr: 0.100000, Time: 6.61s
Clean ACC: 6194/8000 = 0.774250, Loss: 0.6646641492843628
ASR: 335/7193 = 0.046573


<Backdoor Training> Train Epoch: 9 	Loss: 0.429956, lr: 0.100000, Time: 6.33s
Clean ACC: 6330/8000 = 0.791250, Loss: 0.6254129409790039
ASR: 491/7193 = 0.068261


<Backdoor Training> Train Epoch: 10 	Loss: 0.693050, lr: 0.100000, Time: 6.46s
Clean ACC: 6528/8000 = 0.816000, Loss: 0.5474967360496521
ASR: 469/7193 = 0.065202


<Backdoor Training> Train Epoch: 11 	Loss: 0.501301, lr: 0.100000, Time: 6.66s
Clean ACC: 6540/8000 = 0.817500, Loss: 0.5577719807624817
ASR: 1355/7193 = 0.188378


<Backdoor Training> Train Epoch: 12 	Loss: 0.569223, lr: 0.100000, Time: 6.58s
Clean ACC: 6521/8000 = 0.815125, Loss: 0.5451228618621826
ASR: 5978/7193 = 0.831086


<Backdoor Training> Train Epoch: 13 	Loss: 0.457849, lr: 0.100000, Time: 6.63s
Clean ACC: 6715/8000 = 0.839375, Loss: 0.4751918315887451
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 14 	Loss: 0.351225, lr: 0.100000, Time: 6.61s
Clean ACC: 6804/8000 = 0.850500, Loss: 0.43751493096351624
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 15 	Loss: 0.357034, lr: 0.100000, Time: 6.80s
Clean ACC: 6789/8000 = 0.848625, Loss: 0.4622541666030884
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 16 	Loss: 0.429242, lr: 0.100000, Time: 6.53s
Clean ACC: 6817/8000 = 0.852125, Loss: 0.42702019214630127
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 17 	Loss: 0.304505, lr: 0.100000, Time: 6.57s
Clean ACC: 6923/8000 = 0.865375, Loss: 0.4201120436191559
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 18 	Loss: 0.229960, lr: 0.100000, Time: 6.49s
Clean ACC: 6862/8000 = 0.857750, Loss: 0.4267581105232239
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 19 	Loss: 0.210985, lr: 0.100000, Time: 6.61s
Clean ACC: 6860/8000 = 0.857500, Loss: 0.43903136253356934
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 20 	Loss: 0.359173, lr: 0.100000, Time: 6.72s
Clean ACC: 6805/8000 = 0.850625, Loss: 0.46745267510414124
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 21 	Loss: 0.160628, lr: 0.100000, Time: 6.66s
Clean ACC: 6976/8000 = 0.872000, Loss: 0.4084530770778656
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 22 	Loss: 0.303730, lr: 0.100000, Time: 6.51s
Clean ACC: 7011/8000 = 0.876375, Loss: 0.38669395446777344
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 23 	Loss: 0.152618, lr: 0.100000, Time: 6.61s
Clean ACC: 6928/8000 = 0.866000, Loss: 0.4212596118450165
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 24 	Loss: 0.222452, lr: 0.100000, Time: 6.66s
Clean ACC: 6994/8000 = 0.874250, Loss: 0.3835252523422241
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 25 	Loss: 0.317929, lr: 0.100000, Time: 6.58s
Clean ACC: 6968/8000 = 0.871000, Loss: 0.4058409631252289
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 26 	Loss: 0.152794, lr: 0.100000, Time: 6.61s
Clean ACC: 7101/8000 = 0.887625, Loss: 0.3611607551574707
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 27 	Loss: 0.269425, lr: 0.100000, Time: 6.43s
Clean ACC: 7116/8000 = 0.889500, Loss: 0.35162118077278137
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 28 	Loss: 0.369831, lr: 0.100000, Time: 6.44s
Clean ACC: 7004/8000 = 0.875500, Loss: 0.3857216536998749
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 29 	Loss: 0.208308, lr: 0.100000, Time: 6.41s
Clean ACC: 7060/8000 = 0.882500, Loss: 0.3569696545600891
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 30 	Loss: 0.172772, lr: 0.100000, Time: 6.36s
Clean ACC: 7086/8000 = 0.885750, Loss: 0.3721946179866791
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 31 	Loss: 0.265997, lr: 0.100000, Time: 6.49s
Clean ACC: 6951/8000 = 0.868875, Loss: 0.4299488067626953
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 32 	Loss: 0.162721, lr: 0.100000, Time: 6.55s
Clean ACC: 6806/8000 = 0.850750, Loss: 0.4853200614452362
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 33 	Loss: 0.330397, lr: 0.100000, Time: 6.56s
Clean ACC: 7069/8000 = 0.883625, Loss: 0.380654513835907
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 34 	Loss: 0.149299, lr: 0.100000, Time: 6.49s
Clean ACC: 7041/8000 = 0.880125, Loss: 0.3987649083137512
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 35 	Loss: 0.183500, lr: 0.100000, Time: 6.41s
Clean ACC: 7008/8000 = 0.876000, Loss: 0.4033866226673126
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 36 	Loss: 0.153814, lr: 0.100000, Time: 6.35s
Clean ACC: 7069/8000 = 0.883625, Loss: 0.3903058171272278
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 37 	Loss: 0.127620, lr: 0.100000, Time: 6.42s
Clean ACC: 7117/8000 = 0.889625, Loss: 0.36656707525253296
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 38 	Loss: 0.160315, lr: 0.100000, Time: 6.51s
Clean ACC: 7020/8000 = 0.877500, Loss: 0.4249820411205292
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 39 	Loss: 0.172219, lr: 0.100000, Time: 6.44s
Clean ACC: 7147/8000 = 0.893375, Loss: 0.35032904148101807
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 40 	Loss: 0.146356, lr: 0.100000, Time: 6.34s
Clean ACC: 7062/8000 = 0.882750, Loss: 0.4043974280357361
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 41 	Loss: 0.332671, lr: 0.100000, Time: 6.51s
Clean ACC: 7073/8000 = 0.884125, Loss: 0.39832019805908203
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 42 	Loss: 0.271154, lr: 0.100000, Time: 6.38s
Clean ACC: 7087/8000 = 0.885875, Loss: 0.3950560986995697
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 43 	Loss: 0.073708, lr: 0.100000, Time: 6.48s
Clean ACC: 7142/8000 = 0.892750, Loss: 0.35591790080070496
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 44 	Loss: 0.142328, lr: 0.100000, Time: 6.42s
Clean ACC: 6980/8000 = 0.872500, Loss: 0.4305676519870758
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 45 	Loss: 0.236726, lr: 0.100000, Time: 6.41s
Clean ACC: 7127/8000 = 0.890875, Loss: 0.3718498647212982
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 46 	Loss: 0.070696, lr: 0.100000, Time: 6.47s
Clean ACC: 7131/8000 = 0.891375, Loss: 0.35424232482910156
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 47 	Loss: 0.162639, lr: 0.100000, Time: 6.45s
Clean ACC: 7106/8000 = 0.888250, Loss: 0.3862987160682678
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 48 	Loss: 0.268929, lr: 0.100000, Time: 6.42s
Clean ACC: 7061/8000 = 0.882625, Loss: 0.40259483456611633
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 49 	Loss: 0.094519, lr: 0.100000, Time: 6.50s
Clean ACC: 7161/8000 = 0.895125, Loss: 0.3691311180591583
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 50 	Loss: 0.045694, lr: 0.100000, Time: 6.45s
Clean ACC: 7191/8000 = 0.898875, Loss: 0.33710458874702454
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 51 	Loss: 0.024761, lr: 0.010000, Time: 6.38s
Clean ACC: 7439/8000 = 0.929875, Loss: 0.2410382628440857
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 52 	Loss: 0.082853, lr: 0.010000, Time: 6.44s
Clean ACC: 7460/8000 = 0.932500, Loss: 0.24459485709667206
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 53 	Loss: 0.011620, lr: 0.010000, Time: 6.47s
Clean ACC: 7465/8000 = 0.933125, Loss: 0.24741312861442566
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 54 	Loss: 0.046886, lr: 0.010000, Time: 6.48s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.2502732276916504
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 55 	Loss: 0.036531, lr: 0.010000, Time: 6.59s
Clean ACC: 7462/8000 = 0.932750, Loss: 0.2545381784439087
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 56 	Loss: 0.025532, lr: 0.010000, Time: 6.51s
Clean ACC: 7475/8000 = 0.934375, Loss: 0.2573762536048889
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 57 	Loss: 0.031382, lr: 0.010000, Time: 6.51s
Clean ACC: 7466/8000 = 0.933250, Loss: 0.2589511573314667
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 58 	Loss: 0.011777, lr: 0.010000, Time: 6.38s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.2640680968761444
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 59 	Loss: 0.011493, lr: 0.010000, Time: 6.33s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.26289838552474976
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 60 	Loss: 0.003117, lr: 0.010000, Time: 6.46s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.26609086990356445
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 61 	Loss: 0.013383, lr: 0.010000, Time: 6.47s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.2704133689403534
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 62 	Loss: 0.010113, lr: 0.010000, Time: 6.30s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.26825734972953796
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 63 	Loss: 0.004424, lr: 0.010000, Time: 6.58s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.2729874849319458
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 64 	Loss: 0.008770, lr: 0.010000, Time: 6.45s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.27197596430778503
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 65 	Loss: 0.012179, lr: 0.010000, Time: 6.23s
Clean ACC: 7475/8000 = 0.934375, Loss: 0.2751350700855255
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 66 	Loss: 0.002296, lr: 0.010000, Time: 6.45s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2758655548095703
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 67 	Loss: 0.002119, lr: 0.010000, Time: 6.50s
Clean ACC: 7477/8000 = 0.934625, Loss: 0.2797212302684784
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 68 	Loss: 0.026985, lr: 0.010000, Time: 6.30s
Clean ACC: 7491/8000 = 0.936375, Loss: 0.27830538153648376
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 69 	Loss: 0.002323, lr: 0.010000, Time: 6.44s
Clean ACC: 7471/8000 = 0.933875, Loss: 0.2834358215332031
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 70 	Loss: 0.004091, lr: 0.010000, Time: 6.37s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.28230804204940796
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 71 	Loss: 0.017928, lr: 0.010000, Time: 6.38s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.2823616564273834
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 72 	Loss: 0.005733, lr: 0.010000, Time: 6.46s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.28620001673698425
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 73 	Loss: 0.006485, lr: 0.010000, Time: 6.38s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.28471407294273376
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 74 	Loss: 0.000796, lr: 0.010000, Time: 6.49s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.28450658917427063
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 75 	Loss: 0.002697, lr: 0.010000, Time: 6.59s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2850012481212616
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 76 	Loss: 0.000775, lr: 0.001000, Time: 6.44s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2842673063278198
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 77 	Loss: 0.001810, lr: 0.001000, Time: 6.33s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.2848551571369171
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 78 	Loss: 0.001346, lr: 0.001000, Time: 6.44s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.2821987569332123
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 79 	Loss: 0.005713, lr: 0.001000, Time: 6.47s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.2819170355796814
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 80 	Loss: 0.001492, lr: 0.001000, Time: 6.35s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2844715416431427
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 81 	Loss: 0.008371, lr: 0.001000, Time: 6.50s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.28279778361320496
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 82 	Loss: 0.013222, lr: 0.001000, Time: 6.53s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.2829672694206238
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 83 	Loss: 0.021051, lr: 0.001000, Time: 6.52s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.28378891944885254
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 84 	Loss: 0.001699, lr: 0.001000, Time: 6.46s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.2827189266681671
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 85 	Loss: 0.000953, lr: 0.001000, Time: 6.50s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2813873589038849
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 86 	Loss: 0.058541, lr: 0.001000, Time: 6.37s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2846202850341797
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 87 	Loss: 0.000326, lr: 0.001000, Time: 6.32s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2811853289604187
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 88 	Loss: 0.027007, lr: 0.001000, Time: 6.51s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.28342363238334656
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 89 	Loss: 0.000676, lr: 0.001000, Time: 6.42s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2809714078903198
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 90 	Loss: 0.001034, lr: 0.001000, Time: 6.35s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.28210368752479553
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 91 	Loss: 0.028656, lr: 0.001000, Time: 6.49s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.2829693555831909
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 92 	Loss: 0.001246, lr: 0.001000, Time: 6.53s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.28210824728012085
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 93 	Loss: 0.002368, lr: 0.001000, Time: 6.30s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.2840319275856018
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 94 	Loss: 0.004636, lr: 0.001000, Time: 6.51s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.28263387084007263
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 95 	Loss: 0.001505, lr: 0.001000, Time: 6.43s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.2826840579509735
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 96 	Loss: 0.001844, lr: 0.001000, Time: 6.41s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.2814721465110779
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 97 	Loss: 0.000831, lr: 0.001000, Time: 6.50s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.28438708186149597
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 98 	Loss: 0.003485, lr: 0.001000, Time: 6.32s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2813754081726074
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 99 	Loss: 0.000938, lr: 0.001000, Time: 6.37s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.28391385078430176
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 100 	Loss: 0.004236, lr: 0.001000, Time: 6.51s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830561101436615
ASR: 7193/7193 = 1.000000


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830561101436615
ASR: 7193/7193 = 1.000000

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/pca_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/tsne_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/umap_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Mean L2 distance between poison and clean: 7.725760459899902
Saved figure at assets/mean_diff_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
torch.Size([5450])
Saved figure at assets/SS_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/isomap_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/lle_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/kpca_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2830525040626526
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.230063, poison_dis: 8.503932
Saved figure at assets/spectral_cifar10_adaptive_patch_0.010_cover=0.000_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/none
No trigger mask found! By default masking all black pixels...
Evaluating model 'poisoned_train_set/cifar10/adaptive_patch_0.010_cover=0.000_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.80000305175781
asr: 100.0
target label: tensor([0], device='cuda:0')
start_index: 5
TPR: 100.00
FPR: 10.51
AUC: 0.9875
f1 score: 0.9500623478415771
Elapsed time: 14.82s
Experiment for cifar10 with adaptive_patch completed.
