Creating poisoned training set for badnet_all_to_all on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.662788, lr: 0.100000, Time: 10.69s
Clean ACC: 3298/8000 = 0.412250, Loss: 1.6064834594726562
ASR: 481/8000 = 0.060125


<Backdoor Training> Train Epoch: 2 	Loss: 1.536918, lr: 0.100000, Time: 6.37s
Clean ACC: 3789/8000 = 0.473625, Loss: 1.4105325937271118
ASR: 393/8000 = 0.049125


<Backdoor Training> Train Epoch: 3 	Loss: 1.258915, lr: 0.100000, Time: 6.26s
Clean ACC: 4584/8000 = 0.573000, Loss: 1.2113113403320312
ASR: 306/8000 = 0.038250


<Backdoor Training> Train Epoch: 4 	Loss: 0.980877, lr: 0.100000, Time: 6.27s
Clean ACC: 5173/8000 = 0.646625, Loss: 0.993582546710968
ASR: 321/8000 = 0.040125


<Backdoor Training> Train Epoch: 5 	Loss: 0.796626, lr: 0.100000, Time: 6.28s
Clean ACC: 5599/8000 = 0.699875, Loss: 0.854612410068512
ASR: 269/8000 = 0.033625


<Backdoor Training> Train Epoch: 6 	Loss: 0.896763, lr: 0.100000, Time: 6.28s
Clean ACC: 5763/8000 = 0.720375, Loss: 0.7962073683738708
ASR: 210/8000 = 0.026250


<Backdoor Training> Train Epoch: 7 	Loss: 0.601768, lr: 0.100000, Time: 6.36s
Clean ACC: 5929/8000 = 0.741125, Loss: 0.7620509266853333
ASR: 181/8000 = 0.022625


<Backdoor Training> Train Epoch: 8 	Loss: 0.529537, lr: 0.100000, Time: 6.27s
Clean ACC: 6303/8000 = 0.787875, Loss: 0.624866247177124
ASR: 151/8000 = 0.018875


<Backdoor Training> Train Epoch: 9 	Loss: 0.658079, lr: 0.100000, Time: 6.24s
Clean ACC: 6454/8000 = 0.806750, Loss: 0.5687172412872314
ASR: 139/8000 = 0.017375


<Backdoor Training> Train Epoch: 10 	Loss: 0.501050, lr: 0.100000, Time: 6.28s
Clean ACC: 6359/8000 = 0.794875, Loss: 0.6031094789505005
ASR: 140/8000 = 0.017500


<Backdoor Training> Train Epoch: 11 	Loss: 0.592400, lr: 0.100000, Time: 6.29s
Clean ACC: 6419/8000 = 0.802375, Loss: 0.5710725784301758
ASR: 132/8000 = 0.016500


<Backdoor Training> Train Epoch: 12 	Loss: 0.516948, lr: 0.100000, Time: 6.26s
Clean ACC: 6514/8000 = 0.814250, Loss: 0.5483683943748474
ASR: 448/8000 = 0.056000


<Backdoor Training> Train Epoch: 13 	Loss: 0.476876, lr: 0.100000, Time: 6.24s
Clean ACC: 6716/8000 = 0.839500, Loss: 0.4795241057872772
ASR: 1495/8000 = 0.186875


<Backdoor Training> Train Epoch: 14 	Loss: 0.296015, lr: 0.100000, Time: 6.36s
Clean ACC: 6769/8000 = 0.846125, Loss: 0.4615359306335449
ASR: 3036/8000 = 0.379500


<Backdoor Training> Train Epoch: 15 	Loss: 0.284928, lr: 0.100000, Time: 6.29s
Clean ACC: 6762/8000 = 0.845250, Loss: 0.4527454972267151
ASR: 3114/8000 = 0.389250


<Backdoor Training> Train Epoch: 16 	Loss: 0.268763, lr: 0.100000, Time: 6.31s
Clean ACC: 6970/8000 = 0.871250, Loss: 0.3928534686565399
ASR: 3572/8000 = 0.446500


<Backdoor Training> Train Epoch: 17 	Loss: 0.344025, lr: 0.100000, Time: 6.28s
Clean ACC: 6922/8000 = 0.865250, Loss: 0.4209255576133728
ASR: 4797/8000 = 0.599625


<Backdoor Training> Train Epoch: 18 	Loss: 0.333528, lr: 0.100000, Time: 6.29s
Clean ACC: 6939/8000 = 0.867375, Loss: 0.410556823015213
ASR: 4300/8000 = 0.537500


<Backdoor Training> Train Epoch: 19 	Loss: 0.303004, lr: 0.100000, Time: 6.30s
Clean ACC: 6932/8000 = 0.866500, Loss: 0.4109348654747009
ASR: 4661/8000 = 0.582625


<Backdoor Training> Train Epoch: 20 	Loss: 0.352410, lr: 0.100000, Time: 6.32s
Clean ACC: 6975/8000 = 0.871875, Loss: 0.39955639839172363
ASR: 5883/8000 = 0.735375


<Backdoor Training> Train Epoch: 21 	Loss: 0.306620, lr: 0.100000, Time: 6.30s
Clean ACC: 6868/8000 = 0.858500, Loss: 0.4434667229652405
ASR: 5529/8000 = 0.691125


<Backdoor Training> Train Epoch: 22 	Loss: 0.225582, lr: 0.100000, Time: 6.44s
Clean ACC: 6861/8000 = 0.857625, Loss: 0.4446326792240143
ASR: 5559/8000 = 0.694875


<Backdoor Training> Train Epoch: 23 	Loss: 0.239348, lr: 0.100000, Time: 6.26s
Clean ACC: 7047/8000 = 0.880875, Loss: 0.3792657256126404
ASR: 6239/8000 = 0.779875


<Backdoor Training> Train Epoch: 24 	Loss: 0.148661, lr: 0.100000, Time: 6.15s
Clean ACC: 6933/8000 = 0.866625, Loss: 0.41761982440948486
ASR: 5936/8000 = 0.742000


<Backdoor Training> Train Epoch: 25 	Loss: 0.249757, lr: 0.100000, Time: 6.31s
Clean ACC: 7082/8000 = 0.885250, Loss: 0.3562798798084259
ASR: 6021/8000 = 0.752625


<Backdoor Training> Train Epoch: 26 	Loss: 0.267524, lr: 0.100000, Time: 6.35s
Clean ACC: 7033/8000 = 0.879125, Loss: 0.39710089564323425
ASR: 5968/8000 = 0.746000


<Backdoor Training> Train Epoch: 27 	Loss: 0.285515, lr: 0.100000, Time: 6.26s
Clean ACC: 7008/8000 = 0.876000, Loss: 0.4073772728443146
ASR: 5214/8000 = 0.651750


<Backdoor Training> Train Epoch: 28 	Loss: 0.161708, lr: 0.100000, Time: 6.32s
Clean ACC: 7017/8000 = 0.877125, Loss: 0.4040408134460449
ASR: 3099/8000 = 0.387375


<Backdoor Training> Train Epoch: 29 	Loss: 0.273482, lr: 0.100000, Time: 6.21s
Clean ACC: 7093/8000 = 0.886625, Loss: 0.3806556165218353
ASR: 5679/8000 = 0.709875


<Backdoor Training> Train Epoch: 30 	Loss: 0.123102, lr: 0.100000, Time: 6.45s
Clean ACC: 7042/8000 = 0.880250, Loss: 0.3801462948322296
ASR: 5915/8000 = 0.739375


<Backdoor Training> Train Epoch: 31 	Loss: 0.330580, lr: 0.100000, Time: 6.25s
Clean ACC: 7044/8000 = 0.880500, Loss: 0.39235973358154297
ASR: 6045/8000 = 0.755625


<Backdoor Training> Train Epoch: 32 	Loss: 0.158317, lr: 0.100000, Time: 6.37s
Clean ACC: 7002/8000 = 0.875250, Loss: 0.4262107312679291
ASR: 6235/8000 = 0.779375


<Backdoor Training> Train Epoch: 33 	Loss: 0.154820, lr: 0.100000, Time: 6.23s
Clean ACC: 7102/8000 = 0.887750, Loss: 0.3749457001686096
ASR: 6247/8000 = 0.780875


<Backdoor Training> Train Epoch: 34 	Loss: 0.324099, lr: 0.100000, Time: 6.36s
Clean ACC: 7004/8000 = 0.875500, Loss: 0.41079479455947876
ASR: 6590/8000 = 0.823750


<Backdoor Training> Train Epoch: 35 	Loss: 0.117606, lr: 0.100000, Time: 6.19s
Clean ACC: 7033/8000 = 0.879125, Loss: 0.41151121258735657
ASR: 6065/8000 = 0.758125


<Backdoor Training> Train Epoch: 36 	Loss: 0.322545, lr: 0.100000, Time: 6.37s
Clean ACC: 6942/8000 = 0.867750, Loss: 0.4445819556713104
ASR: 5558/8000 = 0.694750


<Backdoor Training> Train Epoch: 37 	Loss: 0.191861, lr: 0.100000, Time: 6.13s
Clean ACC: 7163/8000 = 0.895375, Loss: 0.35871660709381104
ASR: 6725/8000 = 0.840625


<Backdoor Training> Train Epoch: 38 	Loss: 0.209357, lr: 0.100000, Time: 6.30s
Clean ACC: 7060/8000 = 0.882500, Loss: 0.3940216600894928
ASR: 5717/8000 = 0.714625


<Backdoor Training> Train Epoch: 39 	Loss: 0.203655, lr: 0.100000, Time: 6.37s
Clean ACC: 7097/8000 = 0.887125, Loss: 0.3745608925819397
ASR: 6525/8000 = 0.815625


<Backdoor Training> Train Epoch: 40 	Loss: 0.176088, lr: 0.100000, Time: 6.39s
Clean ACC: 7096/8000 = 0.887000, Loss: 0.39704567193984985
ASR: 5981/8000 = 0.747625


<Backdoor Training> Train Epoch: 41 	Loss: 0.236017, lr: 0.100000, Time: 6.27s
Clean ACC: 7174/8000 = 0.896750, Loss: 0.32812145352363586
ASR: 6123/8000 = 0.765375


<Backdoor Training> Train Epoch: 42 	Loss: 0.090185, lr: 0.100000, Time: 6.20s
Clean ACC: 7018/8000 = 0.877250, Loss: 0.4211825430393219
ASR: 4201/8000 = 0.525125


<Backdoor Training> Train Epoch: 43 	Loss: 0.273256, lr: 0.100000, Time: 6.31s
Clean ACC: 7154/8000 = 0.894250, Loss: 0.36457502841949463
ASR: 5569/8000 = 0.696125


<Backdoor Training> Train Epoch: 44 	Loss: 0.232662, lr: 0.100000, Time: 6.27s
Clean ACC: 6999/8000 = 0.874875, Loss: 0.4604525864124298
ASR: 6114/8000 = 0.764250


<Backdoor Training> Train Epoch: 45 	Loss: 0.178721, lr: 0.100000, Time: 6.23s
Clean ACC: 6958/8000 = 0.869750, Loss: 0.4706742763519287
ASR: 6364/8000 = 0.795500


<Backdoor Training> Train Epoch: 46 	Loss: 0.228058, lr: 0.100000, Time: 6.47s
Clean ACC: 7161/8000 = 0.895125, Loss: 0.34250369668006897
ASR: 5790/8000 = 0.723750


<Backdoor Training> Train Epoch: 47 	Loss: 0.297620, lr: 0.100000, Time: 6.21s
Clean ACC: 7113/8000 = 0.889125, Loss: 0.39592549204826355
ASR: 6566/8000 = 0.820750


<Backdoor Training> Train Epoch: 48 	Loss: 0.218928, lr: 0.100000, Time: 6.19s
Clean ACC: 7103/8000 = 0.887875, Loss: 0.38273686170578003
ASR: 5807/8000 = 0.725875


<Backdoor Training> Train Epoch: 49 	Loss: 0.196663, lr: 0.100000, Time: 6.21s
Clean ACC: 7137/8000 = 0.892125, Loss: 0.37310877442359924
ASR: 5727/8000 = 0.715875


<Backdoor Training> Train Epoch: 50 	Loss: 0.150796, lr: 0.100000, Time: 6.40s
Clean ACC: 7120/8000 = 0.890000, Loss: 0.3804229199886322
ASR: 6318/8000 = 0.789750


<Backdoor Training> Train Epoch: 51 	Loss: 0.038625, lr: 0.010000, Time: 6.28s
Clean ACC: 7443/8000 = 0.930375, Loss: 0.23212192952632904
ASR: 7032/8000 = 0.879000


<Backdoor Training> Train Epoch: 52 	Loss: 0.030262, lr: 0.010000, Time: 6.31s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.22919557988643646
ASR: 7098/8000 = 0.887250


<Backdoor Training> Train Epoch: 53 	Loss: 0.035215, lr: 0.010000, Time: 6.24s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.2375720739364624
ASR: 7121/8000 = 0.890125


<Backdoor Training> Train Epoch: 54 	Loss: 0.100418, lr: 0.010000, Time: 6.22s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.24295257031917572
ASR: 7086/8000 = 0.885750


<Backdoor Training> Train Epoch: 55 	Loss: 0.029045, lr: 0.010000, Time: 6.43s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.24132119119167328
ASR: 7148/8000 = 0.893500


<Backdoor Training> Train Epoch: 56 	Loss: 0.089740, lr: 0.010000, Time: 6.24s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.24324187636375427
ASR: 7159/8000 = 0.894875


<Backdoor Training> Train Epoch: 57 	Loss: 0.007938, lr: 0.010000, Time: 6.29s
Clean ACC: 7485/8000 = 0.935625, Loss: 0.2463759481906891
ASR: 7147/8000 = 0.893375


<Backdoor Training> Train Epoch: 58 	Loss: 0.010262, lr: 0.010000, Time: 6.35s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.24801567196846008
ASR: 7149/8000 = 0.893625


<Backdoor Training> Train Epoch: 59 	Loss: 0.093979, lr: 0.010000, Time: 6.24s
Clean ACC: 7505/8000 = 0.938125, Loss: 0.25227996706962585
ASR: 7152/8000 = 0.894000


<Backdoor Training> Train Epoch: 60 	Loss: 0.040524, lr: 0.010000, Time: 6.20s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2526988983154297
ASR: 7121/8000 = 0.890125


<Backdoor Training> Train Epoch: 61 	Loss: 0.018583, lr: 0.010000, Time: 6.32s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.2547968626022339
ASR: 7072/8000 = 0.884000


<Backdoor Training> Train Epoch: 62 	Loss: 0.038452, lr: 0.010000, Time: 6.34s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.2588961124420166
ASR: 7127/8000 = 0.890875


<Backdoor Training> Train Epoch: 63 	Loss: 0.004321, lr: 0.010000, Time: 6.19s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.2559530436992645
ASR: 7104/8000 = 0.888000


<Backdoor Training> Train Epoch: 64 	Loss: 0.004673, lr: 0.010000, Time: 6.24s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2631572484970093
ASR: 7097/8000 = 0.887125


<Backdoor Training> Train Epoch: 65 	Loss: 0.005145, lr: 0.010000, Time: 6.37s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.2645128071308136
ASR: 7119/8000 = 0.889875


<Backdoor Training> Train Epoch: 66 	Loss: 0.022953, lr: 0.010000, Time: 6.22s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.26253554224967957
ASR: 7109/8000 = 0.888625


<Backdoor Training> Train Epoch: 67 	Loss: 0.006103, lr: 0.010000, Time: 6.23s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.2717213034629822
ASR: 7105/8000 = 0.888125


<Backdoor Training> Train Epoch: 68 	Loss: 0.004900, lr: 0.010000, Time: 6.22s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.27086272835731506
ASR: 6942/8000 = 0.867750


<Backdoor Training> Train Epoch: 69 	Loss: 0.007093, lr: 0.010000, Time: 6.29s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.27186664938926697
ASR: 6933/8000 = 0.866625


<Backdoor Training> Train Epoch: 70 	Loss: 0.013927, lr: 0.010000, Time: 6.46s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.27090954780578613
ASR: 6999/8000 = 0.874875


<Backdoor Training> Train Epoch: 71 	Loss: 0.008200, lr: 0.010000, Time: 6.26s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2721690535545349
ASR: 6989/8000 = 0.873625


<Backdoor Training> Train Epoch: 72 	Loss: 0.004343, lr: 0.010000, Time: 6.33s
Clean ACC: 7485/8000 = 0.935625, Loss: 0.2762930691242218
ASR: 6861/8000 = 0.857625


<Backdoor Training> Train Epoch: 73 	Loss: 0.004937, lr: 0.010000, Time: 6.28s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2760433852672577
ASR: 6856/8000 = 0.857000


<Backdoor Training> Train Epoch: 74 	Loss: 0.014149, lr: 0.010000, Time: 6.56s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.2755848169326782
ASR: 6704/8000 = 0.838000


<Backdoor Training> Train Epoch: 75 	Loss: 0.019654, lr: 0.010000, Time: 6.22s
Clean ACC: 7488/8000 = 0.936000, Loss: 0.28205353021621704
ASR: 6866/8000 = 0.858250


<Backdoor Training> Train Epoch: 76 	Loss: 0.006123, lr: 0.001000, Time: 6.37s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.2782818078994751
ASR: 6859/8000 = 0.857375


<Backdoor Training> Train Epoch: 77 	Loss: 0.023124, lr: 0.001000, Time: 6.34s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.27928563952445984
ASR: 6899/8000 = 0.862375


<Backdoor Training> Train Epoch: 78 	Loss: 0.021604, lr: 0.001000, Time: 6.36s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.2768213748931885
ASR: 6908/8000 = 0.863500


<Backdoor Training> Train Epoch: 79 	Loss: 0.004292, lr: 0.001000, Time: 6.39s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.27888840436935425
ASR: 6907/8000 = 0.863375


<Backdoor Training> Train Epoch: 80 	Loss: 0.003422, lr: 0.001000, Time: 6.45s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.27654871344566345
ASR: 6865/8000 = 0.858125


<Backdoor Training> Train Epoch: 81 	Loss: 0.007007, lr: 0.001000, Time: 6.21s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2772127091884613
ASR: 6928/8000 = 0.866000


<Backdoor Training> Train Epoch: 82 	Loss: 0.004408, lr: 0.001000, Time: 6.40s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.27626723051071167
ASR: 6867/8000 = 0.858375


<Backdoor Training> Train Epoch: 83 	Loss: 0.020152, lr: 0.001000, Time: 6.29s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.276699036359787
ASR: 6893/8000 = 0.861625


<Backdoor Training> Train Epoch: 84 	Loss: 0.006217, lr: 0.001000, Time: 6.29s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.27578839659690857
ASR: 6860/8000 = 0.857500


<Backdoor Training> Train Epoch: 85 	Loss: 0.010777, lr: 0.001000, Time: 6.67s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.27635204792022705
ASR: 6826/8000 = 0.853250


<Backdoor Training> Train Epoch: 86 	Loss: 0.010782, lr: 0.001000, Time: 6.74s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.27556467056274414
ASR: 6852/8000 = 0.856500


<Backdoor Training> Train Epoch: 87 	Loss: 0.008682, lr: 0.001000, Time: 6.78s
Clean ACC: 7507/8000 = 0.938375, Loss: 0.2762546241283417
ASR: 6864/8000 = 0.858000


<Backdoor Training> Train Epoch: 88 	Loss: 0.003857, lr: 0.001000, Time: 6.79s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.2774401605129242
ASR: 6880/8000 = 0.860000


<Backdoor Training> Train Epoch: 89 	Loss: 0.004639, lr: 0.001000, Time: 6.84s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.27670422196388245
ASR: 6859/8000 = 0.857375


<Backdoor Training> Train Epoch: 90 	Loss: 0.063554, lr: 0.001000, Time: 6.66s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.27865344285964966
ASR: 6858/8000 = 0.857250


<Backdoor Training> Train Epoch: 91 	Loss: 0.019803, lr: 0.001000, Time: 6.72s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.27917349338531494
ASR: 6864/8000 = 0.858000


<Backdoor Training> Train Epoch: 92 	Loss: 0.008764, lr: 0.001000, Time: 6.77s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.2770525813102722
ASR: 6836/8000 = 0.854500


<Backdoor Training> Train Epoch: 93 	Loss: 0.027065, lr: 0.001000, Time: 6.82s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.2780463695526123
ASR: 6845/8000 = 0.855625


<Backdoor Training> Train Epoch: 94 	Loss: 0.010758, lr: 0.001000, Time: 6.76s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.28066402673721313
ASR: 6844/8000 = 0.855500


<Backdoor Training> Train Epoch: 95 	Loss: 0.002936, lr: 0.001000, Time: 6.28s
Clean ACC: 7504/8000 = 0.938000, Loss: 0.28030112385749817
ASR: 6775/8000 = 0.846875


<Backdoor Training> Train Epoch: 96 	Loss: 0.041104, lr: 0.001000, Time: 6.32s
Clean ACC: 7503/8000 = 0.937875, Loss: 0.27924707531929016
ASR: 6705/8000 = 0.838125


<Backdoor Training> Train Epoch: 97 	Loss: 0.002216, lr: 0.001000, Time: 6.36s
Clean ACC: 7512/8000 = 0.939000, Loss: 0.27881667017936707
ASR: 6798/8000 = 0.849750


<Backdoor Training> Train Epoch: 98 	Loss: 0.011453, lr: 0.001000, Time: 6.41s
Clean ACC: 7507/8000 = 0.938375, Loss: 0.27837491035461426
ASR: 6747/8000 = 0.843375


<Backdoor Training> Train Epoch: 99 	Loss: 0.005749, lr: 0.001000, Time: 6.35s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.278717577457428
ASR: 6777/8000 = 0.847125


<Backdoor Training> Train Epoch: 100 	Loss: 0.003234, lr: 0.001000, Time: 6.30s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785983383655548
ASR: 6796/8000 = 0.849500


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785983383655548
ASR: 6796/8000 = 0.849500

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/pca_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/tsne_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/umap_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Mean L2 distance between poison and clean: 10.64663028717041
Saved figure at assets/mean_diff_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
torch.Size([4997])
Saved figure at assets/SS_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/isomap_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/lle_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/kpca_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2785997688770294
ASR: 818/7263 = 0.112626

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.554200, poison_dis: 11.080265
Saved figure at assets/spectral_cifar10_badnet_all_to_all_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/badnet_patch_32.png
trigger_mask_path: ./triggers/mask_badnet_patch_32.png
Evaluating model 'poisoned_train_set/cifar10/badnet_all_to_all_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.88750457763672
asr: 84.62393951416016
target label: tensor([4], device='cuda:0')
start_index: 10
TPR: 8.76
FPR: 4.29
AUC: 0.4160
f1 score: 0.15501990269792126
Elapsed time: 18.70s
Experiment for cifar10 with badnet_all_to_all completed.
