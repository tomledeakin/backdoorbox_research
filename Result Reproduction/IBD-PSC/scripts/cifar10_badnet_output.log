Creating poisoned training set for badnet on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.628079, lr: 0.100000, Time: 10.17s
Clean ACC: 3118/8000 = 0.389750, Loss: 1.5896328687667847
ASR: 278/7193 = 0.038649


<Backdoor Training> Train Epoch: 2 	Loss: 1.239223, lr: 0.100000, Time: 6.26s
Clean ACC: 3829/8000 = 0.478625, Loss: 1.473591685295105
ASR: 329/7193 = 0.045739


<Backdoor Training> Train Epoch: 3 	Loss: 1.063997, lr: 0.100000, Time: 6.27s
Clean ACC: 4834/8000 = 0.604250, Loss: 1.1265318393707275
ASR: 371/7193 = 0.051578


<Backdoor Training> Train Epoch: 4 	Loss: 1.032196, lr: 0.100000, Time: 6.27s
Clean ACC: 5147/8000 = 0.643375, Loss: 1.0012067556381226
ASR: 118/7193 = 0.016405


<Backdoor Training> Train Epoch: 5 	Loss: 1.081286, lr: 0.100000, Time: 6.15s
Clean ACC: 5478/8000 = 0.684750, Loss: 0.9052584171295166
ASR: 539/7193 = 0.074934


<Backdoor Training> Train Epoch: 6 	Loss: 0.832171, lr: 0.100000, Time: 6.29s
Clean ACC: 5734/8000 = 0.716750, Loss: 0.8126699924468994
ASR: 333/7193 = 0.046295


<Backdoor Training> Train Epoch: 7 	Loss: 0.587707, lr: 0.100000, Time: 6.22s
Clean ACC: 5972/8000 = 0.746500, Loss: 0.7547925710678101
ASR: 155/7193 = 0.021549


<Backdoor Training> Train Epoch: 8 	Loss: 0.618695, lr: 0.100000, Time: 6.22s
Clean ACC: 5728/8000 = 0.716000, Loss: 0.8888000845909119
ASR: 62/7193 = 0.008619


<Backdoor Training> Train Epoch: 9 	Loss: 0.628189, lr: 0.100000, Time: 6.29s
Clean ACC: 6418/8000 = 0.802250, Loss: 0.5750118494033813
ASR: 390/7193 = 0.054219


<Backdoor Training> Train Epoch: 10 	Loss: 0.678546, lr: 0.100000, Time: 6.20s
Clean ACC: 6542/8000 = 0.817750, Loss: 0.5356597900390625
ASR: 6061/7193 = 0.842625


<Backdoor Training> Train Epoch: 11 	Loss: 0.514337, lr: 0.100000, Time: 6.36s
Clean ACC: 6614/8000 = 0.826750, Loss: 0.5159226655960083
ASR: 7167/7193 = 0.996385


<Backdoor Training> Train Epoch: 12 	Loss: 0.508478, lr: 0.100000, Time: 6.48s
Clean ACC: 6634/8000 = 0.829250, Loss: 0.5115213990211487
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 13 	Loss: 0.334625, lr: 0.100000, Time: 6.35s
Clean ACC: 6641/8000 = 0.830125, Loss: 0.49293607473373413
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 14 	Loss: 0.493091, lr: 0.100000, Time: 6.26s
Clean ACC: 6761/8000 = 0.845125, Loss: 0.45095643401145935
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 15 	Loss: 0.287161, lr: 0.100000, Time: 6.19s
Clean ACC: 6596/8000 = 0.824500, Loss: 0.5335912704467773
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 16 	Loss: 0.459839, lr: 0.100000, Time: 6.20s
Clean ACC: 6913/8000 = 0.864125, Loss: 0.4141992926597595
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 17 	Loss: 0.209565, lr: 0.100000, Time: 6.20s
Clean ACC: 6892/8000 = 0.861500, Loss: 0.3975795805454254
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 18 	Loss: 0.328138, lr: 0.100000, Time: 6.33s
Clean ACC: 6984/8000 = 0.873000, Loss: 0.3854818642139435
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 19 	Loss: 0.250868, lr: 0.100000, Time: 6.19s
Clean ACC: 6918/8000 = 0.864750, Loss: 0.40457409620285034
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 20 	Loss: 0.262309, lr: 0.100000, Time: 6.25s
Clean ACC: 6878/8000 = 0.859750, Loss: 0.4356745481491089
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 21 	Loss: 0.172978, lr: 0.100000, Time: 6.32s
Clean ACC: 6983/8000 = 0.872875, Loss: 0.3814079761505127
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 22 	Loss: 0.192003, lr: 0.100000, Time: 6.37s
Clean ACC: 6911/8000 = 0.863875, Loss: 0.4426132142543793
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 23 	Loss: 0.219552, lr: 0.100000, Time: 6.17s
Clean ACC: 6959/8000 = 0.869875, Loss: 0.43570780754089355
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 24 	Loss: 0.246112, lr: 0.100000, Time: 6.20s
Clean ACC: 7033/8000 = 0.879125, Loss: 0.39201611280441284
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 25 	Loss: 0.210041, lr: 0.100000, Time: 6.32s
Clean ACC: 6904/8000 = 0.863000, Loss: 0.4284305274486542
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 26 	Loss: 0.194998, lr: 0.100000, Time: 6.21s
Clean ACC: 7045/8000 = 0.880625, Loss: 0.37426599860191345
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 27 	Loss: 0.281861, lr: 0.100000, Time: 6.67s
Clean ACC: 6981/8000 = 0.872625, Loss: 0.4242686927318573
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 28 	Loss: 0.222315, lr: 0.100000, Time: 6.77s
Clean ACC: 7020/8000 = 0.877500, Loss: 0.38351941108703613
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 29 	Loss: 0.270930, lr: 0.100000, Time: 6.62s
Clean ACC: 6985/8000 = 0.873125, Loss: 0.4116148352622986
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 30 	Loss: 0.286745, lr: 0.100000, Time: 6.71s
Clean ACC: 7084/8000 = 0.885500, Loss: 0.37345582246780396
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 31 	Loss: 0.261500, lr: 0.100000, Time: 6.65s
Clean ACC: 6842/8000 = 0.855250, Loss: 0.48777008056640625
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 32 	Loss: 0.317964, lr: 0.100000, Time: 6.79s
Clean ACC: 6970/8000 = 0.871250, Loss: 0.41987144947052
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 33 	Loss: 0.191133, lr: 0.100000, Time: 6.70s
Clean ACC: 6995/8000 = 0.874375, Loss: 0.41047003865242004
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 34 	Loss: 0.314841, lr: 0.100000, Time: 6.69s
Clean ACC: 7122/8000 = 0.890250, Loss: 0.36574023962020874
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 35 	Loss: 0.168852, lr: 0.100000, Time: 6.55s
Clean ACC: 7010/8000 = 0.876250, Loss: 0.39674973487854004
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 36 	Loss: 0.271144, lr: 0.100000, Time: 6.32s
Clean ACC: 7107/8000 = 0.888375, Loss: 0.352281391620636
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 37 	Loss: 0.287527, lr: 0.100000, Time: 6.19s
Clean ACC: 7124/8000 = 0.890500, Loss: 0.3669869005680084
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 38 	Loss: 0.119805, lr: 0.100000, Time: 6.39s
Clean ACC: 7070/8000 = 0.883750, Loss: 0.3946349024772644
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 39 	Loss: 0.241457, lr: 0.100000, Time: 6.24s
Clean ACC: 7006/8000 = 0.875750, Loss: 0.42385345697402954
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 40 	Loss: 0.175501, lr: 0.100000, Time: 6.15s
Clean ACC: 7051/8000 = 0.881375, Loss: 0.393487811088562
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 41 	Loss: 0.131242, lr: 0.100000, Time: 6.17s
Clean ACC: 7122/8000 = 0.890250, Loss: 0.35882678627967834
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 42 	Loss: 0.138295, lr: 0.100000, Time: 6.30s
Clean ACC: 7031/8000 = 0.878875, Loss: 0.3930903673171997
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 43 	Loss: 0.206281, lr: 0.100000, Time: 6.29s
Clean ACC: 7029/8000 = 0.878625, Loss: 0.4026623070240021
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 44 	Loss: 0.085497, lr: 0.100000, Time: 6.15s
Clean ACC: 7100/8000 = 0.887500, Loss: 0.3683990240097046
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 45 	Loss: 0.250714, lr: 0.100000, Time: 6.16s
Clean ACC: 7120/8000 = 0.890000, Loss: 0.37566477060317993
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 46 	Loss: 0.125244, lr: 0.100000, Time: 6.30s
Clean ACC: 7098/8000 = 0.887250, Loss: 0.36465755105018616
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 47 	Loss: 0.120320, lr: 0.100000, Time: 6.17s
Clean ACC: 7136/8000 = 0.892000, Loss: 0.36864179372787476
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 48 	Loss: 0.080780, lr: 0.100000, Time: 6.21s
Clean ACC: 7010/8000 = 0.876250, Loss: 0.4373161792755127
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 49 	Loss: 0.145379, lr: 0.100000, Time: 6.35s
Clean ACC: 7112/8000 = 0.889000, Loss: 0.38461190462112427
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 50 	Loss: 0.092576, lr: 0.100000, Time: 6.31s
Clean ACC: 7020/8000 = 0.877500, Loss: 0.44190987944602966
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 51 	Loss: 0.146069, lr: 0.010000, Time: 6.36s
Clean ACC: 7416/8000 = 0.927000, Loss: 0.2497933804988861
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 52 	Loss: 0.114264, lr: 0.010000, Time: 6.29s
Clean ACC: 7426/8000 = 0.928250, Loss: 0.2470959722995758
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 53 	Loss: 0.066878, lr: 0.010000, Time: 6.31s
Clean ACC: 7450/8000 = 0.931250, Loss: 0.2560875713825226
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 54 	Loss: 0.141897, lr: 0.010000, Time: 6.17s
Clean ACC: 7439/8000 = 0.929875, Loss: 0.2556664049625397
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 55 	Loss: 0.017833, lr: 0.010000, Time: 6.31s
Clean ACC: 7427/8000 = 0.928375, Loss: 0.26209697127342224
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 56 	Loss: 0.010464, lr: 0.010000, Time: 6.15s
Clean ACC: 7436/8000 = 0.929500, Loss: 0.26489031314849854
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 57 	Loss: 0.012044, lr: 0.010000, Time: 6.28s
Clean ACC: 7443/8000 = 0.930375, Loss: 0.2686457931995392
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 58 	Loss: 0.022347, lr: 0.010000, Time: 6.20s
Clean ACC: 7441/8000 = 0.930125, Loss: 0.27126437425613403
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 59 	Loss: 0.034545, lr: 0.010000, Time: 6.29s
Clean ACC: 7468/8000 = 0.933500, Loss: 0.2712061107158661
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 60 	Loss: 0.034629, lr: 0.010000, Time: 6.18s
Clean ACC: 7448/8000 = 0.931000, Loss: 0.27592188119888306
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 61 	Loss: 0.028728, lr: 0.010000, Time: 6.19s
Clean ACC: 7461/8000 = 0.932625, Loss: 0.27700597047805786
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 62 	Loss: 0.059088, lr: 0.010000, Time: 6.22s
Clean ACC: 7454/8000 = 0.931750, Loss: 0.2775145471096039
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 63 	Loss: 0.008689, lr: 0.010000, Time: 6.15s
Clean ACC: 7451/8000 = 0.931375, Loss: 0.285645455121994
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 64 	Loss: 0.025228, lr: 0.010000, Time: 6.21s
Clean ACC: 7453/8000 = 0.931625, Loss: 0.2866407036781311
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 65 	Loss: 0.086916, lr: 0.010000, Time: 6.22s
Clean ACC: 7455/8000 = 0.931875, Loss: 0.2881810665130615
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 66 	Loss: 0.069025, lr: 0.010000, Time: 6.24s
Clean ACC: 7463/8000 = 0.932875, Loss: 0.28693851828575134
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 67 	Loss: 0.072735, lr: 0.010000, Time: 6.19s
Clean ACC: 7450/8000 = 0.931250, Loss: 0.29517149925231934
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 68 	Loss: 0.012657, lr: 0.010000, Time: 6.24s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.28722137212753296
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 69 	Loss: 0.009382, lr: 0.010000, Time: 6.18s
Clean ACC: 7458/8000 = 0.932250, Loss: 0.2919905185699463
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 70 	Loss: 0.008640, lr: 0.010000, Time: 6.20s
Clean ACC: 7456/8000 = 0.932000, Loss: 0.2968888580799103
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 71 	Loss: 0.070287, lr: 0.010000, Time: 6.17s
Clean ACC: 7458/8000 = 0.932250, Loss: 0.2894623875617981
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 72 	Loss: 0.003778, lr: 0.010000, Time: 6.22s
Clean ACC: 7471/8000 = 0.933875, Loss: 0.29079827666282654
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 73 	Loss: 0.005111, lr: 0.010000, Time: 6.18s
Clean ACC: 7465/8000 = 0.933125, Loss: 0.28951525688171387
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 74 	Loss: 0.015917, lr: 0.010000, Time: 6.29s
Clean ACC: 7461/8000 = 0.932625, Loss: 0.2956847548484802
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 75 	Loss: 0.003792, lr: 0.010000, Time: 6.41s
Clean ACC: 7457/8000 = 0.932125, Loss: 0.30428197979927063
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 76 	Loss: 0.006102, lr: 0.001000, Time: 6.30s
Clean ACC: 7469/8000 = 0.933625, Loss: 0.30140918493270874
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 77 	Loss: 0.034075, lr: 0.001000, Time: 6.15s
Clean ACC: 7469/8000 = 0.933625, Loss: 0.30011165142059326
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 78 	Loss: 0.002583, lr: 0.001000, Time: 6.18s
Clean ACC: 7456/8000 = 0.932000, Loss: 0.2995096743106842
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 79 	Loss: 0.003349, lr: 0.001000, Time: 6.26s
Clean ACC: 7468/8000 = 0.933500, Loss: 0.2962980568408966
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 80 	Loss: 0.003085, lr: 0.001000, Time: 6.37s
Clean ACC: 7465/8000 = 0.933125, Loss: 0.29761016368865967
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 81 	Loss: 0.011893, lr: 0.001000, Time: 6.17s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.2947746217250824
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 82 	Loss: 0.003659, lr: 0.001000, Time: 6.16s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.2950392961502075
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 83 	Loss: 0.006527, lr: 0.001000, Time: 6.26s
Clean ACC: 7471/8000 = 0.933875, Loss: 0.29552674293518066
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 84 	Loss: 0.006196, lr: 0.001000, Time: 6.18s
Clean ACC: 7470/8000 = 0.933750, Loss: 0.2960160970687866
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 85 	Loss: 0.004079, lr: 0.001000, Time: 6.36s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.2962101995944977
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 86 	Loss: 0.002001, lr: 0.001000, Time: 6.41s
Clean ACC: 7467/8000 = 0.933375, Loss: 0.2952769100666046
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 87 	Loss: 0.034830, lr: 0.001000, Time: 6.32s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.29486334323883057
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 88 	Loss: 0.019508, lr: 0.001000, Time: 6.27s
Clean ACC: 7466/8000 = 0.933250, Loss: 0.29905685782432556
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 89 	Loss: 0.013436, lr: 0.001000, Time: 6.21s
Clean ACC: 7468/8000 = 0.933500, Loss: 0.2982527017593384
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 90 	Loss: 0.003100, lr: 0.001000, Time: 6.27s
Clean ACC: 7466/8000 = 0.933250, Loss: 0.29764309525489807
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 91 	Loss: 0.003847, lr: 0.001000, Time: 6.24s
Clean ACC: 7467/8000 = 0.933375, Loss: 0.29639434814453125
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 92 	Loss: 0.015958, lr: 0.001000, Time: 6.27s
Clean ACC: 7460/8000 = 0.932500, Loss: 0.29622817039489746
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 93 	Loss: 0.003269, lr: 0.001000, Time: 6.22s
Clean ACC: 7466/8000 = 0.933250, Loss: 0.2971896827220917
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 94 	Loss: 0.024095, lr: 0.001000, Time: 6.36s
Clean ACC: 7473/8000 = 0.934125, Loss: 0.29668372869491577
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 95 	Loss: 0.003450, lr: 0.001000, Time: 6.18s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.294400691986084
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 96 	Loss: 0.002188, lr: 0.001000, Time: 6.30s
Clean ACC: 7471/8000 = 0.933875, Loss: 0.2957179546356201
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 97 	Loss: 0.010861, lr: 0.001000, Time: 6.35s
Clean ACC: 7468/8000 = 0.933500, Loss: 0.2981399893760681
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 98 	Loss: 0.016831, lr: 0.001000, Time: 6.18s
Clean ACC: 7470/8000 = 0.933750, Loss: 0.2964271605014801
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 99 	Loss: 0.002494, lr: 0.001000, Time: 6.28s
Clean ACC: 7460/8000 = 0.932500, Loss: 0.2974969148635864
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 100 	Loss: 0.003830, lr: 0.001000, Time: 6.18s
Clean ACC: 7473/8000 = 0.934125, Loss: 0.29658377170562744
ASR: 7192/7193 = 0.999861


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7473/8000 = 0.934125, Loss: 0.29658377170562744
ASR: 7192/7193 = 0.999861

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/pca_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/tsne_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/umap_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Mean L2 distance between poison and clean: 7.817349433898926
Saved figure at assets/mean_diff_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
torch.Size([5450])
Saved figure at assets/SS_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/isomap_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/lle_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/kpca_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2965676486492157
ASR: 7192/7193 = 0.999861

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.423451, poison_dis: 8.486264
Saved figure at assets/spectral_cifar10_badnet_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/badnet_patch_32.png
trigger_mask_path: ./triggers/mask_badnet_patch_32.png
Evaluating model 'poisoned_train_set/cifar10/badnet_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.41250610351562
asr: 99.98609924316406
target label: tensor([0], device='cuda:0')
start_index: 10
TPR: 99.99
FPR: 8.08
AUC: 0.9984
f1 score: 0.9611294683088014
Elapsed time: 18.50s
Experiment for cifar10 with badnet completed.
