Creating poisoned training set for blend on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.680282, lr: 0.100000, Time: 9.01s
Clean ACC: 3598/8000 = 0.449750, Loss: 1.4739307165145874
ASR: 1147/7193 = 0.159461


<Backdoor Training> Train Epoch: 2 	Loss: 1.200927, lr: 0.100000, Time: 6.54s
Clean ACC: 4506/8000 = 0.563250, Loss: 1.2012873888015747
ASR: 754/7193 = 0.104824


<Backdoor Training> Train Epoch: 3 	Loss: 0.945135, lr: 0.100000, Time: 6.28s
Clean ACC: 5093/8000 = 0.636625, Loss: 1.016412615776062
ASR: 2427/7193 = 0.337411


<Backdoor Training> Train Epoch: 4 	Loss: 0.757248, lr: 0.100000, Time: 6.60s
Clean ACC: 5565/8000 = 0.695625, Loss: 0.8599499464035034
ASR: 3088/7193 = 0.429306


<Backdoor Training> Train Epoch: 5 	Loss: 0.969690, lr: 0.100000, Time: 6.61s
Clean ACC: 5833/8000 = 0.729125, Loss: 0.7877335548400879
ASR: 6215/7193 = 0.864034


<Backdoor Training> Train Epoch: 6 	Loss: 0.670330, lr: 0.100000, Time: 6.49s
Clean ACC: 6020/8000 = 0.752500, Loss: 0.7614339590072632
ASR: 5819/7193 = 0.808981


<Backdoor Training> Train Epoch: 7 	Loss: 0.412800, lr: 0.100000, Time: 6.50s
Clean ACC: 6297/8000 = 0.787125, Loss: 0.617575466632843
ASR: 6062/7193 = 0.842764


<Backdoor Training> Train Epoch: 8 	Loss: 0.592370, lr: 0.100000, Time: 6.59s
Clean ACC: 6346/8000 = 0.793250, Loss: 0.6050287485122681
ASR: 6809/7193 = 0.946615


<Backdoor Training> Train Epoch: 9 	Loss: 0.390427, lr: 0.100000, Time: 6.57s
Clean ACC: 6086/8000 = 0.760750, Loss: 0.7322373390197754
ASR: 6571/7193 = 0.913527


<Backdoor Training> Train Epoch: 10 	Loss: 0.171448, lr: 0.100000, Time: 6.59s
Clean ACC: 6621/8000 = 0.827625, Loss: 0.5075852870941162
ASR: 6727/7193 = 0.935215


<Backdoor Training> Train Epoch: 11 	Loss: 0.441099, lr: 0.100000, Time: 6.48s
Clean ACC: 6712/8000 = 0.839000, Loss: 0.4821318984031677
ASR: 6449/7193 = 0.896566


<Backdoor Training> Train Epoch: 12 	Loss: 0.364027, lr: 0.100000, Time: 6.60s
Clean ACC: 6831/8000 = 0.853875, Loss: 0.4417041540145874
ASR: 6782/7193 = 0.942861


<Backdoor Training> Train Epoch: 13 	Loss: 0.483430, lr: 0.100000, Time: 6.60s
Clean ACC: 6850/8000 = 0.856250, Loss: 0.43301570415496826
ASR: 6977/7193 = 0.969971


<Backdoor Training> Train Epoch: 14 	Loss: 0.427415, lr: 0.100000, Time: 6.60s
Clean ACC: 6855/8000 = 0.856875, Loss: 0.43265676498413086
ASR: 6846/7193 = 0.951759


<Backdoor Training> Train Epoch: 15 	Loss: 0.301733, lr: 0.100000, Time: 6.58s
Clean ACC: 6810/8000 = 0.851250, Loss: 0.45340654253959656
ASR: 7126/7193 = 0.990685


<Backdoor Training> Train Epoch: 16 	Loss: 0.249097, lr: 0.100000, Time: 6.57s
Clean ACC: 6888/8000 = 0.861000, Loss: 0.4218065142631531
ASR: 6495/7193 = 0.902961


<Backdoor Training> Train Epoch: 17 	Loss: 0.211632, lr: 0.100000, Time: 6.38s
Clean ACC: 6936/8000 = 0.867000, Loss: 0.41711297631263733
ASR: 6855/7193 = 0.953010


<Backdoor Training> Train Epoch: 18 	Loss: 0.326056, lr: 0.100000, Time: 6.46s
Clean ACC: 6924/8000 = 0.865500, Loss: 0.41526931524276733
ASR: 6634/7193 = 0.922286


<Backdoor Training> Train Epoch: 19 	Loss: 0.339637, lr: 0.100000, Time: 6.50s
Clean ACC: 7029/8000 = 0.878625, Loss: 0.3832259178161621
ASR: 7030/7193 = 0.977339


<Backdoor Training> Train Epoch: 20 	Loss: 0.168535, lr: 0.100000, Time: 6.59s
Clean ACC: 6959/8000 = 0.869875, Loss: 0.39189454913139343
ASR: 6588/7193 = 0.915890


<Backdoor Training> Train Epoch: 21 	Loss: 0.340312, lr: 0.100000, Time: 6.71s
Clean ACC: 6959/8000 = 0.869875, Loss: 0.4130467176437378
ASR: 7038/7193 = 0.978451


<Backdoor Training> Train Epoch: 22 	Loss: 0.148128, lr: 0.100000, Time: 6.73s
Clean ACC: 7102/8000 = 0.887750, Loss: 0.35218101739883423
ASR: 7067/7193 = 0.982483


<Backdoor Training> Train Epoch: 23 	Loss: 0.214902, lr: 0.100000, Time: 6.68s
Clean ACC: 7004/8000 = 0.875500, Loss: 0.3999508023262024
ASR: 6693/7193 = 0.930488


<Backdoor Training> Train Epoch: 24 	Loss: 0.185535, lr: 0.100000, Time: 6.77s
Clean ACC: 7012/8000 = 0.876500, Loss: 0.3793398141860962
ASR: 6964/7193 = 0.968163


<Backdoor Training> Train Epoch: 25 	Loss: 0.071479, lr: 0.100000, Time: 6.48s
Clean ACC: 7117/8000 = 0.889625, Loss: 0.34430184960365295
ASR: 6744/7193 = 0.937578


<Backdoor Training> Train Epoch: 26 	Loss: 0.264519, lr: 0.100000, Time: 6.40s
Clean ACC: 7008/8000 = 0.876000, Loss: 0.37673595547676086
ASR: 6540/7193 = 0.909217


<Backdoor Training> Train Epoch: 27 	Loss: 0.193470, lr: 0.100000, Time: 6.45s
Clean ACC: 6993/8000 = 0.874125, Loss: 0.41747215390205383
ASR: 6937/7193 = 0.964410


<Backdoor Training> Train Epoch: 28 	Loss: 0.189916, lr: 0.100000, Time: 6.53s
Clean ACC: 7176/8000 = 0.897000, Loss: 0.32793810963630676
ASR: 6184/7193 = 0.859725


<Backdoor Training> Train Epoch: 29 	Loss: 0.124655, lr: 0.100000, Time: 6.37s
Clean ACC: 7132/8000 = 0.891500, Loss: 0.37161529064178467
ASR: 6994/7193 = 0.972334


<Backdoor Training> Train Epoch: 30 	Loss: 0.276801, lr: 0.100000, Time: 6.43s
Clean ACC: 7121/8000 = 0.890125, Loss: 0.3702014982700348
ASR: 6910/7193 = 0.960656


<Backdoor Training> Train Epoch: 31 	Loss: 0.146463, lr: 0.100000, Time: 6.36s
Clean ACC: 7110/8000 = 0.888750, Loss: 0.33659031987190247
ASR: 6825/7193 = 0.948839


<Backdoor Training> Train Epoch: 32 	Loss: 0.062447, lr: 0.100000, Time: 6.50s
Clean ACC: 7148/8000 = 0.893500, Loss: 0.3731745779514313
ASR: 6979/7193 = 0.970249


<Backdoor Training> Train Epoch: 33 	Loss: 0.114765, lr: 0.100000, Time: 6.55s
Clean ACC: 7049/8000 = 0.881125, Loss: 0.40925881266593933
ASR: 6587/7193 = 0.915751


<Backdoor Training> Train Epoch: 34 	Loss: 0.129673, lr: 0.100000, Time: 6.32s
Clean ACC: 7023/8000 = 0.877875, Loss: 0.4011898338794708
ASR: 7117/7193 = 0.989434


<Backdoor Training> Train Epoch: 35 	Loss: 0.125340, lr: 0.100000, Time: 6.46s
Clean ACC: 7194/8000 = 0.899250, Loss: 0.34033724665641785
ASR: 7082/7193 = 0.984568


<Backdoor Training> Train Epoch: 36 	Loss: 0.164955, lr: 0.100000, Time: 6.31s
Clean ACC: 6981/8000 = 0.872625, Loss: 0.4355599880218506
ASR: 7092/7193 = 0.985959


<Backdoor Training> Train Epoch: 37 	Loss: 0.242327, lr: 0.100000, Time: 6.47s
Clean ACC: 7064/8000 = 0.883000, Loss: 0.3988285958766937
ASR: 6733/7193 = 0.936049


<Backdoor Training> Train Epoch: 38 	Loss: 0.194856, lr: 0.100000, Time: 6.51s
Clean ACC: 7158/8000 = 0.894750, Loss: 0.3435392677783966
ASR: 6339/7193 = 0.881273


<Backdoor Training> Train Epoch: 39 	Loss: 0.082181, lr: 0.100000, Time: 6.48s
Clean ACC: 7249/8000 = 0.906125, Loss: 0.3120073676109314
ASR: 6728/7193 = 0.935354


<Backdoor Training> Train Epoch: 40 	Loss: 0.191270, lr: 0.100000, Time: 6.34s
Clean ACC: 7215/8000 = 0.901875, Loss: 0.33450382947921753
ASR: 6825/7193 = 0.948839


<Backdoor Training> Train Epoch: 41 	Loss: 0.184708, lr: 0.100000, Time: 6.33s
Clean ACC: 7179/8000 = 0.897375, Loss: 0.3481232523918152
ASR: 6518/7193 = 0.906159


<Backdoor Training> Train Epoch: 42 	Loss: 0.399615, lr: 0.100000, Time: 6.32s
Clean ACC: 6852/8000 = 0.856500, Loss: 0.552496612071991
ASR: 7142/7193 = 0.992910


<Backdoor Training> Train Epoch: 43 	Loss: 0.225898, lr: 0.100000, Time: 6.44s
Clean ACC: 7107/8000 = 0.888375, Loss: 0.37565314769744873
ASR: 6840/7193 = 0.950925


<Backdoor Training> Train Epoch: 44 	Loss: 0.220837, lr: 0.100000, Time: 6.47s
Clean ACC: 7102/8000 = 0.887750, Loss: 0.3870888650417328
ASR: 7073/7193 = 0.983317


<Backdoor Training> Train Epoch: 45 	Loss: 0.150861, lr: 0.100000, Time: 6.49s
Clean ACC: 7211/8000 = 0.901375, Loss: 0.3336885869503021
ASR: 6887/7193 = 0.957459


<Backdoor Training> Train Epoch: 46 	Loss: 0.233412, lr: 0.100000, Time: 6.51s
Clean ACC: 6942/8000 = 0.867750, Loss: 0.4751177132129669
ASR: 6908/7193 = 0.960378


<Backdoor Training> Train Epoch: 47 	Loss: 0.098946, lr: 0.100000, Time: 6.38s
Clean ACC: 7066/8000 = 0.883250, Loss: 0.40615347027778625
ASR: 6633/7193 = 0.922147


<Backdoor Training> Train Epoch: 48 	Loss: 0.081503, lr: 0.100000, Time: 6.36s
Clean ACC: 6912/8000 = 0.864000, Loss: 0.517273485660553
ASR: 6916/7193 = 0.961490


<Backdoor Training> Train Epoch: 49 	Loss: 0.067771, lr: 0.100000, Time: 6.37s
Clean ACC: 7187/8000 = 0.898375, Loss: 0.3450777530670166
ASR: 6669/7193 = 0.927151


<Backdoor Training> Train Epoch: 50 	Loss: 0.077051, lr: 0.100000, Time: 6.45s
Clean ACC: 7137/8000 = 0.892125, Loss: 0.37102362513542175
ASR: 6885/7193 = 0.957181


<Backdoor Training> Train Epoch: 51 	Loss: 0.026755, lr: 0.010000, Time: 6.49s
Clean ACC: 7461/8000 = 0.932625, Loss: 0.2332867532968521
ASR: 7066/7193 = 0.982344


<Backdoor Training> Train Epoch: 52 	Loss: 0.024413, lr: 0.010000, Time: 6.55s
Clean ACC: 7476/8000 = 0.934500, Loss: 0.2296551764011383
ASR: 7014/7193 = 0.975115


<Backdoor Training> Train Epoch: 53 	Loss: 0.017018, lr: 0.010000, Time: 6.36s
Clean ACC: 7479/8000 = 0.934875, Loss: 0.2313096672296524
ASR: 7063/7193 = 0.981927


<Backdoor Training> Train Epoch: 54 	Loss: 0.049071, lr: 0.010000, Time: 6.52s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.23449745774269104
ASR: 7070/7193 = 0.982900


<Backdoor Training> Train Epoch: 55 	Loss: 0.031015, lr: 0.010000, Time: 6.41s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.23872624337673187
ASR: 7051/7193 = 0.980259


<Backdoor Training> Train Epoch: 56 	Loss: 0.045990, lr: 0.010000, Time: 6.40s
Clean ACC: 7488/8000 = 0.936000, Loss: 0.24214863777160645
ASR: 7107/7193 = 0.988044


<Backdoor Training> Train Epoch: 57 	Loss: 0.038673, lr: 0.010000, Time: 6.53s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.23791588842868805
ASR: 7081/7193 = 0.984429


<Backdoor Training> Train Epoch: 58 	Loss: 0.017425, lr: 0.010000, Time: 6.56s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.24118643999099731
ASR: 7089/7193 = 0.985541


<Backdoor Training> Train Epoch: 59 	Loss: 0.028053, lr: 0.010000, Time: 6.34s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.24927721917629242
ASR: 7075/7193 = 0.983595


<Backdoor Training> Train Epoch: 60 	Loss: 0.009210, lr: 0.010000, Time: 6.55s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.24984198808670044
ASR: 7036/7193 = 0.978173


<Backdoor Training> Train Epoch: 61 	Loss: 0.027898, lr: 0.010000, Time: 6.64s
Clean ACC: 7515/8000 = 0.939375, Loss: 0.2519189119338989
ASR: 7083/7193 = 0.984707


<Backdoor Training> Train Epoch: 62 	Loss: 0.008674, lr: 0.010000, Time: 6.42s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.2549824118614197
ASR: 7079/7193 = 0.984151


<Backdoor Training> Train Epoch: 63 	Loss: 0.002514, lr: 0.010000, Time: 6.58s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2563556134700775
ASR: 7071/7193 = 0.983039


<Backdoor Training> Train Epoch: 64 	Loss: 0.011468, lr: 0.010000, Time: 6.53s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.25657084584236145
ASR: 7073/7193 = 0.983317


<Backdoor Training> Train Epoch: 65 	Loss: 0.002278, lr: 0.010000, Time: 6.46s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.25835201144218445
ASR: 7048/7193 = 0.979842


<Backdoor Training> Train Epoch: 66 	Loss: 0.009788, lr: 0.010000, Time: 6.38s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.2643907368183136
ASR: 7090/7193 = 0.985681


<Backdoor Training> Train Epoch: 67 	Loss: 0.019797, lr: 0.010000, Time: 6.50s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.26290208101272583
ASR: 7094/7193 = 0.986237


<Backdoor Training> Train Epoch: 68 	Loss: 0.000880, lr: 0.010000, Time: 6.48s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.2635767459869385
ASR: 7111/7193 = 0.988600


<Backdoor Training> Train Epoch: 69 	Loss: 0.002861, lr: 0.010000, Time: 6.43s
Clean ACC: 7510/8000 = 0.938750, Loss: 0.2633523941040039
ASR: 7095/7193 = 0.986376


<Backdoor Training> Train Epoch: 70 	Loss: 0.001328, lr: 0.010000, Time: 6.58s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.2688710391521454
ASR: 7106/7193 = 0.987905


<Backdoor Training> Train Epoch: 71 	Loss: 0.013660, lr: 0.010000, Time: 6.41s
Clean ACC: 7520/8000 = 0.940000, Loss: 0.2650388777256012
ASR: 7086/7193 = 0.985124


<Backdoor Training> Train Epoch: 72 	Loss: 0.001481, lr: 0.010000, Time: 6.56s
Clean ACC: 7518/8000 = 0.939750, Loss: 0.26641684770584106
ASR: 7083/7193 = 0.984707


<Backdoor Training> Train Epoch: 73 	Loss: 0.005586, lr: 0.010000, Time: 6.45s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.26902374625205994
ASR: 7090/7193 = 0.985681


<Backdoor Training> Train Epoch: 74 	Loss: 0.003515, lr: 0.010000, Time: 6.45s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2679669260978699
ASR: 7085/7193 = 0.984985


<Backdoor Training> Train Epoch: 75 	Loss: 0.012899, lr: 0.010000, Time: 6.54s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.27372661232948303
ASR: 7079/7193 = 0.984151


<Backdoor Training> Train Epoch: 76 	Loss: 0.000621, lr: 0.001000, Time: 6.44s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.2732512354850769
ASR: 7090/7193 = 0.985681


<Backdoor Training> Train Epoch: 77 	Loss: 0.001601, lr: 0.001000, Time: 6.48s
Clean ACC: 7510/8000 = 0.938750, Loss: 0.2691507637500763
ASR: 7097/7193 = 0.986654


<Backdoor Training> Train Epoch: 78 	Loss: 0.003067, lr: 0.001000, Time: 6.49s
Clean ACC: 7508/8000 = 0.938500, Loss: 0.27427157759666443
ASR: 7093/7193 = 0.986098


<Backdoor Training> Train Epoch: 79 	Loss: 0.000566, lr: 0.001000, Time: 6.65s
Clean ACC: 7512/8000 = 0.939000, Loss: 0.27031323313713074
ASR: 7089/7193 = 0.985541


<Backdoor Training> Train Epoch: 80 	Loss: 0.003079, lr: 0.001000, Time: 6.43s
Clean ACC: 7511/8000 = 0.938875, Loss: 0.26923006772994995
ASR: 7113/7193 = 0.988878


<Backdoor Training> Train Epoch: 81 	Loss: 0.007883, lr: 0.001000, Time: 6.38s
Clean ACC: 7517/8000 = 0.939625, Loss: 0.2692047953605652
ASR: 7099/7193 = 0.986932


<Backdoor Training> Train Epoch: 82 	Loss: 0.000825, lr: 0.001000, Time: 6.36s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.26869988441467285
ASR: 7100/7193 = 0.987071


<Backdoor Training> Train Epoch: 83 	Loss: 0.001145, lr: 0.001000, Time: 6.55s
Clean ACC: 7517/8000 = 0.939625, Loss: 0.2693195641040802
ASR: 7116/7193 = 0.989295


<Backdoor Training> Train Epoch: 84 	Loss: 0.002195, lr: 0.001000, Time: 6.47s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2705996632575989
ASR: 7096/7193 = 0.986515


<Backdoor Training> Train Epoch: 85 	Loss: 0.004046, lr: 0.001000, Time: 6.39s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2710748314857483
ASR: 7093/7193 = 0.986098


<Backdoor Training> Train Epoch: 86 	Loss: 0.001515, lr: 0.001000, Time: 6.51s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.26885414123535156
ASR: 7092/7193 = 0.985959


<Backdoor Training> Train Epoch: 87 	Loss: 0.006562, lr: 0.001000, Time: 6.39s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2684558033943176
ASR: 7104/7193 = 0.987627


<Backdoor Training> Train Epoch: 88 	Loss: 0.000953, lr: 0.001000, Time: 6.47s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.26848238706588745
ASR: 7093/7193 = 0.986098


<Backdoor Training> Train Epoch: 89 	Loss: 0.000639, lr: 0.001000, Time: 6.44s
Clean ACC: 7516/8000 = 0.939500, Loss: 0.2708420753479004
ASR: 7095/7193 = 0.986376


<Backdoor Training> Train Epoch: 90 	Loss: 0.002462, lr: 0.001000, Time: 6.58s
Clean ACC: 7529/8000 = 0.941125, Loss: 0.26876509189605713
ASR: 7093/7193 = 0.986098


<Backdoor Training> Train Epoch: 91 	Loss: 0.004056, lr: 0.001000, Time: 6.40s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2686629891395569
ASR: 7099/7193 = 0.986932


<Backdoor Training> Train Epoch: 92 	Loss: 0.003069, lr: 0.001000, Time: 6.49s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2682217061519623
ASR: 7095/7193 = 0.986376


<Backdoor Training> Train Epoch: 93 	Loss: 0.000474, lr: 0.001000, Time: 6.52s
Clean ACC: 7518/8000 = 0.939750, Loss: 0.26869964599609375
ASR: 7094/7193 = 0.986237


<Backdoor Training> Train Epoch: 94 	Loss: 0.000421, lr: 0.001000, Time: 6.41s
Clean ACC: 7523/8000 = 0.940375, Loss: 0.2684507668018341
ASR: 7109/7193 = 0.988322


<Backdoor Training> Train Epoch: 95 	Loss: 0.002612, lr: 0.001000, Time: 6.36s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2699417769908905
ASR: 7099/7193 = 0.986932


<Backdoor Training> Train Epoch: 96 	Loss: 0.005453, lr: 0.001000, Time: 6.43s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2698925733566284
ASR: 7103/7193 = 0.987488


<Backdoor Training> Train Epoch: 97 	Loss: 0.000387, lr: 0.001000, Time: 6.61s
Clean ACC: 7523/8000 = 0.940375, Loss: 0.2715209722518921
ASR: 7108/7193 = 0.988183


<Backdoor Training> Train Epoch: 98 	Loss: 0.000465, lr: 0.001000, Time: 6.46s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.2700880169868469
ASR: 7095/7193 = 0.986376


<Backdoor Training> Train Epoch: 99 	Loss: 0.001663, lr: 0.001000, Time: 6.46s
Clean ACC: 7514/8000 = 0.939250, Loss: 0.26859337091445923
ASR: 7078/7193 = 0.984012


<Backdoor Training> Train Epoch: 100 	Loss: 0.001132, lr: 0.001000, Time: 6.31s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.270093709230423
ASR: 7095/7193 = 0.986376


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7524/8000 = 0.940500, Loss: 0.270093709230423
ASR: 7095/7193 = 0.986376

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/pca_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/tsne_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/umap_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Mean L2 distance between poison and clean: 6.210133075714111
Saved figure at assets/mean_diff_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
torch.Size([5450])
Saved figure at assets/SS_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/isomap_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/lle_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/kpca_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.2700987756252289
ASR: 7095/7193 = 0.986376

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.218395, poison_dis: 6.542289
Saved figure at assets/spectral_cifar10_blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/hellokitty_32.png
trigger_mask_path: ./triggers/mask_hellokitty_32.png
Evaluating model 'poisoned_train_set/cifar10/blend_0.010_alpha=0.200_trigger=hellokitty_32.png_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 94.05000305175781
asr: 98.63756561279297
target label: tensor([0], device='cuda:0')
start_index: 10
TPR: 98.76
FPR: 4.72
AUC: 0.9895
f1 score: 0.9706984458504823
Elapsed time: 16.72s
Experiment for cifar10 with blend completed.
