Creating poisoned training set for trojan on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.600120, lr: 0.100000, Time: 10.25s
Clean ACC: 3357/8000 = 0.419625, Loss: 1.5622369050979614
ASR: 374/7193 = 0.051995


<Backdoor Training> Train Epoch: 2 	Loss: 1.330850, lr: 0.100000, Time: 6.46s
Clean ACC: 3789/8000 = 0.473625, Loss: 1.4769132137298584
ASR: 6011/7193 = 0.835674


<Backdoor Training> Train Epoch: 3 	Loss: 0.898672, lr: 0.100000, Time: 6.16s
Clean ACC: 4838/8000 = 0.604750, Loss: 1.1729449033737183
ASR: 6476/7193 = 0.900320


<Backdoor Training> Train Epoch: 4 	Loss: 0.779902, lr: 0.100000, Time: 6.11s
Clean ACC: 5539/8000 = 0.692375, Loss: 0.9048520922660828
ASR: 7160/7193 = 0.995412


<Backdoor Training> Train Epoch: 5 	Loss: 0.749378, lr: 0.100000, Time: 6.20s
Clean ACC: 5602/8000 = 0.700250, Loss: 0.8578676581382751
ASR: 6738/7193 = 0.936744


<Backdoor Training> Train Epoch: 6 	Loss: 0.747802, lr: 0.100000, Time: 6.23s
Clean ACC: 5926/8000 = 0.740750, Loss: 0.7473664283752441
ASR: 7189/7193 = 0.999444


<Backdoor Training> Train Epoch: 7 	Loss: 0.706205, lr: 0.100000, Time: 6.34s
Clean ACC: 6077/8000 = 0.759625, Loss: 0.7154250741004944
ASR: 7168/7193 = 0.996524


<Backdoor Training> Train Epoch: 8 	Loss: 0.639521, lr: 0.100000, Time: 6.42s
Clean ACC: 5754/8000 = 0.719250, Loss: 0.840592622756958
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 9 	Loss: 0.450953, lr: 0.100000, Time: 6.38s
Clean ACC: 6593/8000 = 0.824125, Loss: 0.5093562006950378
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 10 	Loss: 0.519207, lr: 0.100000, Time: 6.15s
Clean ACC: 6479/8000 = 0.809875, Loss: 0.5576871633529663
ASR: 6779/7193 = 0.942444


<Backdoor Training> Train Epoch: 11 	Loss: 0.338129, lr: 0.100000, Time: 6.20s
Clean ACC: 6724/8000 = 0.840500, Loss: 0.46840789914131165
ASR: 7152/7193 = 0.994300


<Backdoor Training> Train Epoch: 12 	Loss: 0.331428, lr: 0.100000, Time: 6.24s
Clean ACC: 6702/8000 = 0.837750, Loss: 0.4931473433971405
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 13 	Loss: 0.391162, lr: 0.100000, Time: 6.26s
Clean ACC: 6633/8000 = 0.829125, Loss: 0.5204342603683472
ASR: 7180/7193 = 0.998193


<Backdoor Training> Train Epoch: 14 	Loss: 0.379517, lr: 0.100000, Time: 6.28s
Clean ACC: 6839/8000 = 0.854875, Loss: 0.4403257668018341
ASR: 7168/7193 = 0.996524


<Backdoor Training> Train Epoch: 15 	Loss: 0.274879, lr: 0.100000, Time: 6.26s
Clean ACC: 6751/8000 = 0.843875, Loss: 0.46574100852012634
ASR: 7172/7193 = 0.997080


<Backdoor Training> Train Epoch: 16 	Loss: 0.229446, lr: 0.100000, Time: 6.32s
Clean ACC: 6894/8000 = 0.861750, Loss: 0.4139856696128845
ASR: 7126/7193 = 0.990685


<Backdoor Training> Train Epoch: 17 	Loss: 0.148394, lr: 0.100000, Time: 6.29s
Clean ACC: 6888/8000 = 0.861000, Loss: 0.414713978767395
ASR: 7172/7193 = 0.997080


<Backdoor Training> Train Epoch: 18 	Loss: 0.240991, lr: 0.100000, Time: 6.43s
Clean ACC: 6897/8000 = 0.862125, Loss: 0.43040111660957336
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 19 	Loss: 0.229104, lr: 0.100000, Time: 6.39s
Clean ACC: 7037/8000 = 0.879625, Loss: 0.3710809051990509
ASR: 7153/7193 = 0.994439


<Backdoor Training> Train Epoch: 20 	Loss: 0.185196, lr: 0.100000, Time: 6.23s
Clean ACC: 7016/8000 = 0.877000, Loss: 0.39513900876045227
ASR: 7156/7193 = 0.994856


<Backdoor Training> Train Epoch: 21 	Loss: 0.185089, lr: 0.100000, Time: 6.19s
Clean ACC: 7049/8000 = 0.881125, Loss: 0.3719979524612427
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 22 	Loss: 0.243338, lr: 0.100000, Time: 6.12s
Clean ACC: 7019/8000 = 0.877375, Loss: 0.38945114612579346
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 23 	Loss: 0.166511, lr: 0.100000, Time: 6.42s
Clean ACC: 7090/8000 = 0.886250, Loss: 0.3481261134147644
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 24 	Loss: 0.229220, lr: 0.100000, Time: 6.28s
Clean ACC: 7083/8000 = 0.885375, Loss: 0.35607466101646423
ASR: 7191/7193 = 0.999722


<Backdoor Training> Train Epoch: 25 	Loss: 0.106243, lr: 0.100000, Time: 6.27s
Clean ACC: 6855/8000 = 0.856875, Loss: 0.4338400065898895
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 26 	Loss: 0.094717, lr: 0.100000, Time: 6.41s
Clean ACC: 7035/8000 = 0.879375, Loss: 0.40713974833488464
ASR: 7151/7193 = 0.994161


<Backdoor Training> Train Epoch: 27 	Loss: 0.221019, lr: 0.100000, Time: 6.20s
Clean ACC: 6874/8000 = 0.859250, Loss: 0.4575906991958618
ASR: 7173/7193 = 0.997220


<Backdoor Training> Train Epoch: 28 	Loss: 0.141922, lr: 0.100000, Time: 6.25s
Clean ACC: 7071/8000 = 0.883875, Loss: 0.36022135615348816
ASR: 7040/7193 = 0.978729


<Backdoor Training> Train Epoch: 29 	Loss: 0.191883, lr: 0.100000, Time: 6.21s
Clean ACC: 6972/8000 = 0.871500, Loss: 0.4170103371143341
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 30 	Loss: 0.172326, lr: 0.100000, Time: 6.31s
Clean ACC: 7076/8000 = 0.884500, Loss: 0.36663928627967834
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 31 	Loss: 0.289143, lr: 0.100000, Time: 6.39s
Clean ACC: 7096/8000 = 0.887000, Loss: 0.35970523953437805
ASR: 7140/7193 = 0.992632


<Backdoor Training> Train Epoch: 32 	Loss: 0.203181, lr: 0.100000, Time: 6.20s
Clean ACC: 7085/8000 = 0.885625, Loss: 0.38691240549087524
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 33 	Loss: 0.156782, lr: 0.100000, Time: 6.32s
Clean ACC: 7063/8000 = 0.882875, Loss: 0.38829702138900757
ASR: 7125/7193 = 0.990546


<Backdoor Training> Train Epoch: 34 	Loss: 0.236486, lr: 0.100000, Time: 6.34s
Clean ACC: 7181/8000 = 0.897625, Loss: 0.3457506000995636
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 35 	Loss: 0.160395, lr: 0.100000, Time: 6.25s
Clean ACC: 7045/8000 = 0.880625, Loss: 0.41577452421188354
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 36 	Loss: 0.129242, lr: 0.100000, Time: 6.19s
Clean ACC: 7069/8000 = 0.883625, Loss: 0.39899930357933044
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 37 	Loss: 0.086581, lr: 0.100000, Time: 6.37s
Clean ACC: 7202/8000 = 0.900250, Loss: 0.3346306383609772
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 38 	Loss: 0.197582, lr: 0.100000, Time: 6.35s
Clean ACC: 7118/8000 = 0.889750, Loss: 0.3952941596508026
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 39 	Loss: 0.211987, lr: 0.100000, Time: 6.35s
Clean ACC: 7139/8000 = 0.892375, Loss: 0.36763980984687805
ASR: 7191/7193 = 0.999722


<Backdoor Training> Train Epoch: 40 	Loss: 0.097836, lr: 0.100000, Time: 6.63s
Clean ACC: 7090/8000 = 0.886250, Loss: 0.3769591748714447
ASR: 7173/7193 = 0.997220


<Backdoor Training> Train Epoch: 41 	Loss: 0.136464, lr: 0.100000, Time: 6.72s
Clean ACC: 7142/8000 = 0.892750, Loss: 0.3784067630767822
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 42 	Loss: 0.022903, lr: 0.100000, Time: 6.58s
Clean ACC: 7186/8000 = 0.898250, Loss: 0.35565418004989624
ASR: 7191/7193 = 0.999722


<Backdoor Training> Train Epoch: 43 	Loss: 0.127618, lr: 0.100000, Time: 6.73s
Clean ACC: 7184/8000 = 0.898000, Loss: 0.34112223982810974
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 44 	Loss: 0.139041, lr: 0.100000, Time: 6.73s
Clean ACC: 7016/8000 = 0.877000, Loss: 0.4343315362930298
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 45 	Loss: 0.229638, lr: 0.100000, Time: 6.66s
Clean ACC: 7173/8000 = 0.896625, Loss: 0.3553962707519531
ASR: 7185/7193 = 0.998888


<Backdoor Training> Train Epoch: 46 	Loss: 0.142538, lr: 0.100000, Time: 6.67s
Clean ACC: 7242/8000 = 0.905250, Loss: 0.30674993991851807
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 47 	Loss: 0.230896, lr: 0.100000, Time: 6.70s
Clean ACC: 7218/8000 = 0.902250, Loss: 0.3327564597129822
ASR: 7187/7193 = 0.999166


<Backdoor Training> Train Epoch: 48 	Loss: 0.163932, lr: 0.100000, Time: 6.78s
Clean ACC: 7250/8000 = 0.906250, Loss: 0.3189295828342438
ASR: 7175/7193 = 0.997498


<Backdoor Training> Train Epoch: 49 	Loss: 0.064852, lr: 0.100000, Time: 6.30s
Clean ACC: 7158/8000 = 0.894750, Loss: 0.3779294788837433
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 50 	Loss: 0.084642, lr: 0.100000, Time: 6.33s
Clean ACC: 7166/8000 = 0.895750, Loss: 0.37438151240348816
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 51 	Loss: 0.030328, lr: 0.010000, Time: 6.38s
Clean ACC: 7408/8000 = 0.926000, Loss: 0.24440497159957886
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 52 	Loss: 0.013127, lr: 0.010000, Time: 6.33s
Clean ACC: 7438/8000 = 0.929750, Loss: 0.24048303067684174
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 53 	Loss: 0.005491, lr: 0.010000, Time: 6.15s
Clean ACC: 7435/8000 = 0.929375, Loss: 0.24303342401981354
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 54 	Loss: 0.035116, lr: 0.010000, Time: 6.22s
Clean ACC: 7446/8000 = 0.930750, Loss: 0.2383231520652771
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 55 	Loss: 0.012946, lr: 0.010000, Time: 6.26s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.2428891658782959
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 56 	Loss: 0.027921, lr: 0.010000, Time: 6.27s
Clean ACC: 7485/8000 = 0.935625, Loss: 0.24264681339263916
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 57 	Loss: 0.008918, lr: 0.010000, Time: 6.24s
Clean ACC: 7473/8000 = 0.934125, Loss: 0.2443072646856308
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 58 	Loss: 0.013303, lr: 0.010000, Time: 6.27s
Clean ACC: 7472/8000 = 0.934000, Loss: 0.25267454981803894
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 59 	Loss: 0.002898, lr: 0.010000, Time: 6.35s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.25057855248451233
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 60 	Loss: 0.008026, lr: 0.010000, Time: 6.30s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.252683162689209
ASR: 7189/7193 = 0.999444


<Backdoor Training> Train Epoch: 61 	Loss: 0.008371, lr: 0.010000, Time: 6.20s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.2566421926021576
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 62 	Loss: 0.002148, lr: 0.010000, Time: 6.17s
Clean ACC: 7496/8000 = 0.937000, Loss: 0.25492584705352783
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 63 	Loss: 0.055851, lr: 0.010000, Time: 6.32s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.2600381076335907
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 64 	Loss: 0.011249, lr: 0.010000, Time: 6.35s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2600598931312561
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 65 	Loss: 0.005530, lr: 0.010000, Time: 6.31s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.25770533084869385
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 66 	Loss: 0.001410, lr: 0.010000, Time: 6.14s
Clean ACC: 7495/8000 = 0.936875, Loss: 0.26153045892715454
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 67 	Loss: 0.001738, lr: 0.010000, Time: 6.15s
Clean ACC: 7498/8000 = 0.937250, Loss: 0.2630576193332672
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 68 	Loss: 0.000859, lr: 0.010000, Time: 6.28s
Clean ACC: 7507/8000 = 0.938375, Loss: 0.2604111433029175
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 69 	Loss: 0.001148, lr: 0.010000, Time: 6.30s
Clean ACC: 7518/8000 = 0.939750, Loss: 0.26237690448760986
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 70 	Loss: 0.001344, lr: 0.010000, Time: 6.30s
Clean ACC: 7515/8000 = 0.939375, Loss: 0.26151856780052185
ASR: 7192/7193 = 0.999861


<Backdoor Training> Train Epoch: 71 	Loss: 0.002496, lr: 0.010000, Time: 6.23s
Clean ACC: 7509/8000 = 0.938625, Loss: 0.264771968126297
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 72 	Loss: 0.001151, lr: 0.010000, Time: 6.27s
Clean ACC: 7515/8000 = 0.939375, Loss: 0.2645520567893982
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 73 	Loss: 0.003024, lr: 0.010000, Time: 6.19s
Clean ACC: 7506/8000 = 0.938250, Loss: 0.26442456245422363
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 74 	Loss: 0.007087, lr: 0.010000, Time: 6.28s
Clean ACC: 7512/8000 = 0.939000, Loss: 0.2659093737602234
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 75 	Loss: 0.003627, lr: 0.010000, Time: 6.28s
Clean ACC: 7521/8000 = 0.940125, Loss: 0.2658817768096924
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 76 	Loss: 0.003109, lr: 0.001000, Time: 6.16s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2676836848258972
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 77 	Loss: 0.000970, lr: 0.001000, Time: 6.17s
Clean ACC: 7527/8000 = 0.940875, Loss: 0.26536524295806885
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 78 	Loss: 0.004241, lr: 0.001000, Time: 6.18s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.2666161358356476
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 79 	Loss: 0.002237, lr: 0.001000, Time: 6.20s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.26571816205978394
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 80 	Loss: 0.002288, lr: 0.001000, Time: 6.26s
Clean ACC: 7520/8000 = 0.940000, Loss: 0.2664607763290405
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 81 	Loss: 0.002921, lr: 0.001000, Time: 6.14s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.264656126499176
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 82 	Loss: 0.000555, lr: 0.001000, Time: 6.19s
Clean ACC: 7523/8000 = 0.940375, Loss: 0.2645327150821686
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 83 	Loss: 0.002344, lr: 0.001000, Time: 6.20s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.26828625798225403
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 84 	Loss: 0.002697, lr: 0.001000, Time: 6.29s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.26449233293533325
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 85 	Loss: 0.000460, lr: 0.001000, Time: 6.23s
Clean ACC: 7529/8000 = 0.941125, Loss: 0.2653205692768097
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 86 	Loss: 0.000812, lr: 0.001000, Time: 6.38s
Clean ACC: 7525/8000 = 0.940625, Loss: 0.2686789333820343
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 87 	Loss: 0.002526, lr: 0.001000, Time: 6.35s
Clean ACC: 7526/8000 = 0.940750, Loss: 0.265719473361969
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 88 	Loss: 0.006293, lr: 0.001000, Time: 6.33s
Clean ACC: 7521/8000 = 0.940125, Loss: 0.26773539185523987
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 89 	Loss: 0.003320, lr: 0.001000, Time: 6.34s
Clean ACC: 7533/8000 = 0.941625, Loss: 0.26646655797958374
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 90 	Loss: 0.007644, lr: 0.001000, Time: 6.36s
Clean ACC: 7522/8000 = 0.940250, Loss: 0.266864538192749
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 91 	Loss: 0.022495, lr: 0.001000, Time: 6.18s
Clean ACC: 7517/8000 = 0.939625, Loss: 0.266755610704422
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 92 	Loss: 0.001166, lr: 0.001000, Time: 6.32s
Clean ACC: 7520/8000 = 0.940000, Loss: 0.268732488155365
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 93 	Loss: 0.004130, lr: 0.001000, Time: 6.31s
Clean ACC: 7518/8000 = 0.939750, Loss: 0.26716259121894836
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 94 	Loss: 0.007144, lr: 0.001000, Time: 6.27s
Clean ACC: 7531/8000 = 0.941375, Loss: 0.26674163341522217
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 95 	Loss: 0.001091, lr: 0.001000, Time: 6.15s
Clean ACC: 7519/8000 = 0.939875, Loss: 0.2667692005634308
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 96 	Loss: 0.003403, lr: 0.001000, Time: 6.28s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.26610425114631653
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 97 	Loss: 0.007357, lr: 0.001000, Time: 6.34s
Clean ACC: 7527/8000 = 0.940875, Loss: 0.26666873693466187
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 98 	Loss: 0.004867, lr: 0.001000, Time: 6.39s
Clean ACC: 7526/8000 = 0.940750, Loss: 0.2656867206096649
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 99 	Loss: 0.002554, lr: 0.001000, Time: 6.25s
Clean ACC: 7528/8000 = 0.941000, Loss: 0.26699984073638916
ASR: 7193/7193 = 1.000000


<Backdoor Training> Train Epoch: 100 	Loss: 0.000490, lr: 0.001000, Time: 6.28s
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26829779148101807
ASR: 7193/7193 = 1.000000


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26829779148101807
ASR: 7193/7193 = 1.000000

Visualizing the model's latent space...
Using method: pca
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/pca_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: tsne
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/tsne_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: umap
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/umap_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: oracle
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
SVM Accuracy: 1.0
Saved figure at assets/oracle_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: mean_diff
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Mean L2 distance between poison and clean: 3.3100619316101074
Saved figure at assets/mean_diff_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: SS
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
torch.Size([5450])
Saved figure at assets/SS_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: isomap
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/isomap_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: lle
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/lle_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: kpca
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/kpca_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Using method: spectral
Visualizing model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7524/8000 = 0.940500, Loss: 0.26831457018852234
ASR: 7193/7193 = 1.000000

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 3.246125, poison_dis: 3.909628
Saved figure at assets/spectral_cifar10_trojan_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/trojan_square_32.png
trigger_mask_path: ./triggers/mask_trojan_square_32.png
Evaluating model 'poisoned_train_set/cifar10/trojan_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 94.05000305175781
asr: 100.0
target label: tensor([0], device='cuda:0')
start_index: 10
TPR: 100.00
FPR: 9.14
AUC: 0.9996
f1 score: 0.9563086486163409
Elapsed time: 18.00s
Experiment for cifar10 with trojan completed.
