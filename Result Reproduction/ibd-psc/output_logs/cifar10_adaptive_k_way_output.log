Creating poisoned training set for adaptive_k_way on cifar10...
[target class : 0]
Files already downloaded and verified
Poisoned set directory 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0' to be created is not empty! Exiting...
Training the model on the poisoned dataset...
dataset : poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/imgs
Will save to 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'.
Model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' already exists!
<Backdoor Training> Train Epoch: 1 	Loss: 1.761091, lr: 0.100000, Time: 10.28s
Clean ACC: 3226/8000 = 0.403250, Loss: 1.5960979461669922
ASR: 134/7193 = 0.018629


<Backdoor Training> Train Epoch: 2 	Loss: 1.574734, lr: 0.100000, Time: 6.38s
Clean ACC: 3843/8000 = 0.480375, Loss: 1.449795126914978
ASR: 351/7193 = 0.048797


<Backdoor Training> Train Epoch: 3 	Loss: 1.217431, lr: 0.100000, Time: 6.22s
Clean ACC: 4645/8000 = 0.580625, Loss: 1.2303847074508667
ASR: 454/7193 = 0.063117


<Backdoor Training> Train Epoch: 4 	Loss: 1.152344, lr: 0.100000, Time: 6.75s
Clean ACC: 5440/8000 = 0.680000, Loss: 0.9020346999168396
ASR: 131/7193 = 0.018212


<Backdoor Training> Train Epoch: 5 	Loss: 0.756983, lr: 0.100000, Time: 6.83s
Clean ACC: 5798/8000 = 0.724750, Loss: 0.7813754081726074
ASR: 205/7193 = 0.028500


<Backdoor Training> Train Epoch: 6 	Loss: 0.663895, lr: 0.100000, Time: 6.74s
Clean ACC: 5946/8000 = 0.743250, Loss: 0.7411388754844666
ASR: 417/7193 = 0.057973


<Backdoor Training> Train Epoch: 7 	Loss: 0.661776, lr: 0.100000, Time: 6.76s
Clean ACC: 6213/8000 = 0.776625, Loss: 0.6605273485183716
ASR: 472/7193 = 0.065619


<Backdoor Training> Train Epoch: 8 	Loss: 0.472797, lr: 0.100000, Time: 6.66s
Clean ACC: 6382/8000 = 0.797750, Loss: 0.5945489406585693
ASR: 172/7193 = 0.023912


<Backdoor Training> Train Epoch: 9 	Loss: 0.746472, lr: 0.100000, Time: 6.73s
Clean ACC: 6547/8000 = 0.818375, Loss: 0.5299426913261414
ASR: 278/7193 = 0.038649


<Backdoor Training> Train Epoch: 10 	Loss: 0.409907, lr: 0.100000, Time: 6.56s
Clean ACC: 6721/8000 = 0.840125, Loss: 0.4814588129520416
ASR: 243/7193 = 0.033783


<Backdoor Training> Train Epoch: 11 	Loss: 0.544258, lr: 0.100000, Time: 6.20s
Clean ACC: 6659/8000 = 0.832375, Loss: 0.4936099648475647
ASR: 114/7193 = 0.015849


<Backdoor Training> Train Epoch: 12 	Loss: 0.412022, lr: 0.100000, Time: 6.33s
Clean ACC: 6652/8000 = 0.831500, Loss: 0.4943832457065582
ASR: 174/7193 = 0.024190


<Backdoor Training> Train Epoch: 13 	Loss: 0.405367, lr: 0.100000, Time: 6.32s
Clean ACC: 6842/8000 = 0.855250, Loss: 0.42925333976745605
ASR: 319/7193 = 0.044349


<Backdoor Training> Train Epoch: 14 	Loss: 0.170379, lr: 0.100000, Time: 6.28s
Clean ACC: 6802/8000 = 0.850250, Loss: 0.45199137926101685
ASR: 301/7193 = 0.041846


<Backdoor Training> Train Epoch: 15 	Loss: 0.298117, lr: 0.100000, Time: 6.69s
Clean ACC: 6714/8000 = 0.839250, Loss: 0.49977800250053406
ASR: 810/7193 = 0.112609


<Backdoor Training> Train Epoch: 16 	Loss: 0.423041, lr: 0.100000, Time: 6.75s
Clean ACC: 6775/8000 = 0.846875, Loss: 0.47602081298828125
ASR: 3510/7193 = 0.487974


<Backdoor Training> Train Epoch: 17 	Loss: 0.439466, lr: 0.100000, Time: 6.48s
Clean ACC: 6932/8000 = 0.866500, Loss: 0.40068626403808594
ASR: 6036/7193 = 0.839149


<Backdoor Training> Train Epoch: 18 	Loss: 0.297423, lr: 0.100000, Time: 6.88s
Clean ACC: 6781/8000 = 0.847625, Loss: 0.48434028029441833
ASR: 5136/7193 = 0.714028


<Backdoor Training> Train Epoch: 19 	Loss: 0.345973, lr: 0.100000, Time: 6.67s
Clean ACC: 6790/8000 = 0.848750, Loss: 0.48255300521850586
ASR: 6390/7193 = 0.888364


<Backdoor Training> Train Epoch: 20 	Loss: 0.197529, lr: 0.100000, Time: 6.73s
Clean ACC: 6952/8000 = 0.869000, Loss: 0.41125020384788513
ASR: 6818/7193 = 0.947866


<Backdoor Training> Train Epoch: 21 	Loss: 0.446391, lr: 0.100000, Time: 6.62s
Clean ACC: 7032/8000 = 0.879000, Loss: 0.379669189453125
ASR: 6401/7193 = 0.889893


<Backdoor Training> Train Epoch: 22 	Loss: 0.251307, lr: 0.100000, Time: 6.40s
Clean ACC: 6922/8000 = 0.865250, Loss: 0.43071049451828003
ASR: 6916/7193 = 0.961490


<Backdoor Training> Train Epoch: 23 	Loss: 0.401537, lr: 0.100000, Time: 6.39s
Clean ACC: 6990/8000 = 0.873750, Loss: 0.41880160570144653
ASR: 7058/7193 = 0.981232


<Backdoor Training> Train Epoch: 24 	Loss: 0.124364, lr: 0.100000, Time: 6.37s
Clean ACC: 7083/8000 = 0.885375, Loss: 0.3639477491378784
ASR: 6914/7193 = 0.961212


<Backdoor Training> Train Epoch: 25 	Loss: 0.339175, lr: 0.100000, Time: 6.34s
Clean ACC: 7035/8000 = 0.879375, Loss: 0.3928639888763428
ASR: 6529/7193 = 0.907688


<Backdoor Training> Train Epoch: 26 	Loss: 0.159394, lr: 0.100000, Time: 6.65s
Clean ACC: 7000/8000 = 0.875000, Loss: 0.4031248986721039
ASR: 6850/7193 = 0.952315


<Backdoor Training> Train Epoch: 27 	Loss: 0.130267, lr: 0.100000, Time: 6.79s
Clean ACC: 6980/8000 = 0.872500, Loss: 0.4193132519721985
ASR: 7069/7193 = 0.982761


<Backdoor Training> Train Epoch: 28 	Loss: 0.207764, lr: 0.100000, Time: 6.74s
Clean ACC: 7096/8000 = 0.887000, Loss: 0.36950135231018066
ASR: 6920/7193 = 0.962046


<Backdoor Training> Train Epoch: 29 	Loss: 0.177586, lr: 0.100000, Time: 6.57s
Clean ACC: 7129/8000 = 0.891125, Loss: 0.3369334042072296
ASR: 6700/7193 = 0.931461


<Backdoor Training> Train Epoch: 30 	Loss: 0.154156, lr: 0.100000, Time: 6.69s
Clean ACC: 7090/8000 = 0.886250, Loss: 0.3797003924846649
ASR: 6992/7193 = 0.972056


<Backdoor Training> Train Epoch: 31 	Loss: 0.240707, lr: 0.100000, Time: 6.63s
Clean ACC: 7029/8000 = 0.878625, Loss: 0.3924527168273926
ASR: 7043/7193 = 0.979146


<Backdoor Training> Train Epoch: 32 	Loss: 0.228782, lr: 0.100000, Time: 6.64s
Clean ACC: 7131/8000 = 0.891375, Loss: 0.366518497467041
ASR: 6996/7193 = 0.972612


<Backdoor Training> Train Epoch: 33 	Loss: 0.174595, lr: 0.100000, Time: 6.26s
Clean ACC: 7086/8000 = 0.885750, Loss: 0.36998164653778076
ASR: 7108/7193 = 0.988183


<Backdoor Training> Train Epoch: 34 	Loss: 0.300362, lr: 0.100000, Time: 6.26s
Clean ACC: 7116/8000 = 0.889500, Loss: 0.35576215386390686
ASR: 7082/7193 = 0.984568


<Backdoor Training> Train Epoch: 35 	Loss: 0.091806, lr: 0.100000, Time: 6.32s
Clean ACC: 7022/8000 = 0.877750, Loss: 0.40422311425209045
ASR: 6850/7193 = 0.952315


<Backdoor Training> Train Epoch: 36 	Loss: 0.128358, lr: 0.100000, Time: 6.37s
Clean ACC: 7137/8000 = 0.892125, Loss: 0.353542298078537
ASR: 7119/7193 = 0.989712


<Backdoor Training> Train Epoch: 37 	Loss: 0.118495, lr: 0.100000, Time: 6.72s
Clean ACC: 7172/8000 = 0.896500, Loss: 0.3328023850917816
ASR: 6930/7193 = 0.963437


<Backdoor Training> Train Epoch: 38 	Loss: 0.151752, lr: 0.100000, Time: 6.78s
Clean ACC: 7054/8000 = 0.881750, Loss: 0.40548405051231384
ASR: 6921/7193 = 0.962185


<Backdoor Training> Train Epoch: 39 	Loss: 0.275389, lr: 0.100000, Time: 6.80s
Clean ACC: 7189/8000 = 0.898625, Loss: 0.3457378149032593
ASR: 7103/7193 = 0.987488


<Backdoor Training> Train Epoch: 40 	Loss: 0.349439, lr: 0.100000, Time: 6.69s
Clean ACC: 6900/8000 = 0.862500, Loss: 0.47813284397125244
ASR: 6988/7193 = 0.971500


<Backdoor Training> Train Epoch: 41 	Loss: 0.159364, lr: 0.100000, Time: 6.73s
Clean ACC: 7109/8000 = 0.888625, Loss: 0.37004518508911133
ASR: 7071/7193 = 0.983039


<Backdoor Training> Train Epoch: 42 	Loss: 0.148253, lr: 0.100000, Time: 6.77s
Clean ACC: 7144/8000 = 0.893000, Loss: 0.33890780806541443
ASR: 7138/7193 = 0.992354


<Backdoor Training> Train Epoch: 43 	Loss: 0.144418, lr: 0.100000, Time: 6.86s
Clean ACC: 7086/8000 = 0.885750, Loss: 0.3887559175491333
ASR: 7121/7193 = 0.989990


<Backdoor Training> Train Epoch: 44 	Loss: 0.221321, lr: 0.100000, Time: 6.46s
Clean ACC: 7162/8000 = 0.895250, Loss: 0.3574797213077545
ASR: 7041/7193 = 0.978868


<Backdoor Training> Train Epoch: 45 	Loss: 0.107762, lr: 0.100000, Time: 6.37s
Clean ACC: 7134/8000 = 0.891750, Loss: 0.3644487261772156
ASR: 7059/7193 = 0.981371


<Backdoor Training> Train Epoch: 46 	Loss: 0.185873, lr: 0.100000, Time: 6.41s
Clean ACC: 7145/8000 = 0.893125, Loss: 0.36844122409820557
ASR: 6705/7193 = 0.932156


<Backdoor Training> Train Epoch: 47 	Loss: 0.265097, lr: 0.100000, Time: 6.32s
Clean ACC: 7049/8000 = 0.881125, Loss: 0.38527798652648926
ASR: 7129/7193 = 0.991102


<Backdoor Training> Train Epoch: 48 	Loss: 0.172511, lr: 0.100000, Time: 6.50s
Clean ACC: 7171/8000 = 0.896375, Loss: 0.3491417169570923
ASR: 7057/7193 = 0.981093


<Backdoor Training> Train Epoch: 49 	Loss: 0.111047, lr: 0.100000, Time: 6.78s
Clean ACC: 7059/8000 = 0.882375, Loss: 0.40196675062179565
ASR: 6846/7193 = 0.951759


<Backdoor Training> Train Epoch: 50 	Loss: 0.202154, lr: 0.100000, Time: 6.63s
Clean ACC: 7206/8000 = 0.900750, Loss: 0.3358890116214752
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 51 	Loss: 0.044067, lr: 0.010000, Time: 6.76s
Clean ACC: 7459/8000 = 0.932375, Loss: 0.23234407603740692
ASR: 7146/7193 = 0.993466


<Backdoor Training> Train Epoch: 52 	Loss: 0.013993, lr: 0.010000, Time: 6.72s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.22881948947906494
ASR: 7152/7193 = 0.994300


<Backdoor Training> Train Epoch: 53 	Loss: 0.013884, lr: 0.010000, Time: 6.81s
Clean ACC: 7475/8000 = 0.934375, Loss: 0.23605966567993164
ASR: 7156/7193 = 0.994856


<Backdoor Training> Train Epoch: 54 	Loss: 0.059724, lr: 0.010000, Time: 6.76s
Clean ACC: 7467/8000 = 0.933375, Loss: 0.23756122589111328
ASR: 7159/7193 = 0.995273


<Backdoor Training> Train Epoch: 55 	Loss: 0.134141, lr: 0.010000, Time: 6.27s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.23844020068645477
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 56 	Loss: 0.035384, lr: 0.010000, Time: 6.31s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.24447022378444672
ASR: 7153/7193 = 0.994439


<Backdoor Training> Train Epoch: 57 	Loss: 0.030054, lr: 0.010000, Time: 6.28s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.2431875318288803
ASR: 7156/7193 = 0.994856


<Backdoor Training> Train Epoch: 58 	Loss: 0.005856, lr: 0.010000, Time: 6.42s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2510834038257599
ASR: 7161/7193 = 0.995551


<Backdoor Training> Train Epoch: 59 	Loss: 0.023372, lr: 0.010000, Time: 6.42s
Clean ACC: 7476/8000 = 0.934500, Loss: 0.2540164291858673
ASR: 7161/7193 = 0.995551


<Backdoor Training> Train Epoch: 60 	Loss: 0.019705, lr: 0.010000, Time: 6.65s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.25636357069015503
ASR: 7156/7193 = 0.994856


<Backdoor Training> Train Epoch: 61 	Loss: 0.003163, lr: 0.010000, Time: 6.63s
Clean ACC: 7476/8000 = 0.934500, Loss: 0.25692659616470337
ASR: 7151/7193 = 0.994161


<Backdoor Training> Train Epoch: 62 	Loss: 0.013576, lr: 0.010000, Time: 6.86s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.2599833309650421
ASR: 7156/7193 = 0.994856


<Backdoor Training> Train Epoch: 63 	Loss: 0.005805, lr: 0.010000, Time: 6.64s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.26042091846466064
ASR: 7162/7193 = 0.995690


<Backdoor Training> Train Epoch: 64 	Loss: 0.005063, lr: 0.010000, Time: 6.78s
Clean ACC: 7497/8000 = 0.937125, Loss: 0.2642973065376282
ASR: 7161/7193 = 0.995551


<Backdoor Training> Train Epoch: 65 	Loss: 0.002245, lr: 0.010000, Time: 6.66s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2674376964569092
ASR: 7160/7193 = 0.995412


<Backdoor Training> Train Epoch: 66 	Loss: 0.002276, lr: 0.010000, Time: 6.20s
Clean ACC: 7502/8000 = 0.937750, Loss: 0.26800307631492615
ASR: 7161/7193 = 0.995551


<Backdoor Training> Train Epoch: 67 	Loss: 0.026520, lr: 0.010000, Time: 6.34s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.2717961370944977
ASR: 7155/7193 = 0.994717


<Backdoor Training> Train Epoch: 68 	Loss: 0.004726, lr: 0.010000, Time: 6.30s
Clean ACC: 7501/8000 = 0.937625, Loss: 0.27270305156707764
ASR: 7159/7193 = 0.995273


<Backdoor Training> Train Epoch: 69 	Loss: 0.005340, lr: 0.010000, Time: 6.38s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2774679362773895
ASR: 7151/7193 = 0.994161


<Backdoor Training> Train Epoch: 70 	Loss: 0.004048, lr: 0.010000, Time: 6.38s
Clean ACC: 7480/8000 = 0.935000, Loss: 0.27952349185943604
ASR: 7161/7193 = 0.995551


<Backdoor Training> Train Epoch: 71 	Loss: 0.002399, lr: 0.010000, Time: 6.68s
Clean ACC: 7500/8000 = 0.937500, Loss: 0.2816305160522461
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 72 	Loss: 0.001404, lr: 0.010000, Time: 6.64s
Clean ACC: 7480/8000 = 0.935000, Loss: 0.2831687927246094
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 73 	Loss: 0.003455, lr: 0.010000, Time: 6.64s
Clean ACC: 7482/8000 = 0.935250, Loss: 0.28188449144363403
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 74 	Loss: 0.015779, lr: 0.010000, Time: 6.68s
Clean ACC: 7474/8000 = 0.934250, Loss: 0.286700963973999
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 75 	Loss: 0.004055, lr: 0.010000, Time: 6.75s
Clean ACC: 7464/8000 = 0.933000, Loss: 0.2865845859050751
ASR: 7159/7193 = 0.995273


<Backdoor Training> Train Epoch: 76 	Loss: 0.006869, lr: 0.001000, Time: 6.74s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.2871457040309906
ASR: 7159/7193 = 0.995273


<Backdoor Training> Train Epoch: 77 	Loss: 0.016865, lr: 0.001000, Time: 6.30s
Clean ACC: 7479/8000 = 0.934875, Loss: 0.2872142493724823
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 78 	Loss: 0.007964, lr: 0.001000, Time: 6.31s
Clean ACC: 7481/8000 = 0.935125, Loss: 0.2863314151763916
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 79 	Loss: 0.003070, lr: 0.001000, Time: 6.20s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.2843719720840454
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 80 	Loss: 0.013975, lr: 0.001000, Time: 6.40s
Clean ACC: 7478/8000 = 0.934750, Loss: 0.2846413850784302
ASR: 7160/7193 = 0.995412


<Backdoor Training> Train Epoch: 81 	Loss: 0.051666, lr: 0.001000, Time: 6.37s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.2848552465438843
ASR: 7162/7193 = 0.995690


<Backdoor Training> Train Epoch: 82 	Loss: 0.001027, lr: 0.001000, Time: 6.67s
Clean ACC: 7484/8000 = 0.935500, Loss: 0.2832421064376831
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 83 	Loss: 0.009769, lr: 0.001000, Time: 6.65s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.28403154015541077
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 84 	Loss: 0.005737, lr: 0.001000, Time: 6.78s
Clean ACC: 7488/8000 = 0.936000, Loss: 0.2838609516620636
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 85 	Loss: 0.011546, lr: 0.001000, Time: 6.79s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.2828619182109833
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 86 	Loss: 0.002517, lr: 0.001000, Time: 6.58s
Clean ACC: 7483/8000 = 0.935375, Loss: 0.2845441997051239
ASR: 7160/7193 = 0.995412


<Backdoor Training> Train Epoch: 87 	Loss: 0.008062, lr: 0.001000, Time: 6.64s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.2837042808532715
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 88 	Loss: 0.006580, lr: 0.001000, Time: 6.44s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2830042839050293
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 89 	Loss: 0.005057, lr: 0.001000, Time: 6.38s
Clean ACC: 7499/8000 = 0.937375, Loss: 0.2837199568748474
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 90 	Loss: 0.001238, lr: 0.001000, Time: 6.30s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2862957715988159
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 91 	Loss: 0.003142, lr: 0.001000, Time: 6.23s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2855585813522339
ASR: 7157/7193 = 0.994995


<Backdoor Training> Train Epoch: 92 	Loss: 0.001612, lr: 0.001000, Time: 6.26s
Clean ACC: 7487/8000 = 0.935875, Loss: 0.2827130854129791
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 93 	Loss: 0.044392, lr: 0.001000, Time: 6.67s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.2835772931575775
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 94 	Loss: 0.002414, lr: 0.001000, Time: 6.63s
Clean ACC: 7490/8000 = 0.936250, Loss: 0.2843049168586731
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 95 	Loss: 0.001515, lr: 0.001000, Time: 6.83s
Clean ACC: 7494/8000 = 0.936750, Loss: 0.28457486629486084
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 96 	Loss: 0.003504, lr: 0.001000, Time: 6.71s
Clean ACC: 7489/8000 = 0.936125, Loss: 0.28318846225738525
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 97 	Loss: 0.001959, lr: 0.001000, Time: 6.66s
Clean ACC: 7486/8000 = 0.935750, Loss: 0.2843206226825714
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 98 	Loss: 0.001635, lr: 0.001000, Time: 6.81s
Clean ACC: 7492/8000 = 0.936500, Loss: 0.2833404242992401
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 99 	Loss: 0.001371, lr: 0.001000, Time: 6.56s
Clean ACC: 7488/8000 = 0.936000, Loss: 0.2841889560222626
ASR: 7158/7193 = 0.995134


<Backdoor Training> Train Epoch: 100 	Loss: 0.002113, lr: 0.001000, Time: 6.35s
Clean ACC: 7493/8000 = 0.936625, Loss: 0.2833336293697357
ASR: 7158/7193 = 0.995134


Testing the backdoor model...
Evaluating model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
Clean ACC: 7493/8000 = 0.936625, Loss: 0.2833336293697357
ASR: 7158/7193 = 0.995134

Visualizing the model's latent space...
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7494/8000 = 0.936750, Loss: 0.28334009647369385
ASR: 7158/7193 = 0.995134

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 2.947202, poison_dis: 6.854731
Silhouette Score: 0.42310524
Saved figure at assets/pca_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7494/8000 = 0.936750, Loss: 0.28334009647369385
ASR: 7158/7193 = 0.995134

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 2.947202, poison_dis: 6.854731
Silhouette Score: 0.42310524
Saved figure at assets/tsne_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Visualizing model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt' on cifar10...
[test]
Clean ACC: 7494/8000 = 0.936750, Loss: 0.28334009647369385
ASR: 7158/7193 = 0.995134

Total Clean: 49500
Total Poisoned: 500
torch.Size([512])
clean_dis: 2.947202, poison_dis: 6.854731
Silhouette Score: 0.42310524
SVM Accuracy: 0.9972477064220183
Saved figure at assets/oracle_cifar10_adaptive_k_way_0.010_poison_seed=0_full_base_aug_seed=2333.pt_class=0.png
Applying IBD_PSC defense method...
trigger_path: ./triggers/none
No trigger mask found! By default masking all black pixels...
Evaluating model 'poisoned_train_set/cifar10/adaptive_k_way_0.010_poison_seed=0/full_base_aug_seed=2333.pt'...
ba: 93.66250610351562
asr: 99.51341247558594
target label: tensor([0], device='cuda:0')
start_index: 6
TPR: 99.46
FPR: 16.29
AUC: 0.9916
f1 score: 0.9220162224797219
Elapsed time: 18.36s
Experiment for cifar10 with adaptive_k_way completed.
